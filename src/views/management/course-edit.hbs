{{#section "styles" append=true}}
<link rel="stylesheet" href="/course-form.css" />
{{/section}}

<main class="main-content">
    <div class="container">
        <section class="section active">
            <h2 class="section-title">‚úèÔ∏è Course Edited</h2>

            {{#if errorUpdate}}
            <div class="alert alert-danger" role="alert"
                style="background-color: #c0392b; color: white; border: none; margin: 0 auto 20px auto; max-width: 900px; text-align: center; font-weight: bold;">
                {{errorUpdate}}
            </div>
            {{/if}}

            <div class="form-container" style="max-width: 900px; margin: 0 auto;">
                {{#with course}} {{!-- S·ª≠ d·ª•ng d·ªØ li·ªáu 'course' ƒë∆∞·ª£c truy·ªÅn t·ª´ route GET --}}
                <form action="/management/course/update" method="POST">
                    {{!-- Hidden input ƒë·ªÉ g·ª≠i CourseID khi submit --}}
                    <input type="hidden" name="CourseID" value="{{CourseID}}" />

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="CourseName">Course Name *</label>
                            <input type="text" class="form-input" id="CourseName" name="CourseName"
                                value="{{CourseName}}" required />
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="Level">Level *</label>
                            <select class="form-select" id="Level" name="Level" required>
                                <option value="Beginner" {{#if (eq Level "Beginner" )}}selected{{/if}}>Beginner</option>
                                <option value="Intermediate" {{#if (eq Level "Intermediate" )}}selected{{/if}}>
                                    Intermediate</option>
                                <option value="Advanced" {{#if (eq Level "Advanced" )}}selected{{/if}}>Advanced</option>
                                <option value="Expert" {{#if (eq Level "Expert" )}}selected{{/if}}>Expert</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row full">
                        <div class="form-group">
                            <label class="form-label" for="SubCatID">Subcategory *</label>
                            <select class="form-select" id="SubCatID" name="SubCatID" required>
                                {{#each ../categories}} {{!-- L·∫•y t·ª´ context cha --}}
                                <optgroup label="{{CatName}}">
                                    {{#each subcategories}}
                                    {{!-- So s√°nh v·ªõi course.SubCatID --}}
                                    <option value="{{SubCatID}}" {{#ifCond ../../course.SubCatID '==='
                                        SubCatID}}selected{{/ifCond}}>{{SubCatName}}</option>
                                    {{/each}}
                                </optgroup>
                                {{/each}}
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="OriginalPrice">Original Price ($) *</label>
                            <input type="number" class="form-input" id="OriginalPrice" name="OriginalPrice" min="0"
                                value="{{OriginalPrice}}" required />
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="CurrentPrice">Current Price ($) *</label>
                            <input type="number" class="form-input" id="CurrentPrice" name="CurrentPrice" min="0"
                                value="{{CurrentPrice}}" required />
                        </div>
                    </div>

                    <div class="form-row full">
                        <div class="form-group">
                            <label class="form-label" for="CourseStatus">Status *</label>
                            <select class="form-select" id="CourseStatus" name="CourseStatus" required>
                                <option value="Completed" {{#ifCond CourseStatus '===' 'Completed'
                                    }}selected{{/ifCond}}>
                                    Completed
                                </option>
                                <option value="draft" {{#ifCond CourseStatus '===' 'draft' }}selected{{/ifCond}}>
                                    Draft
                                </option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row full">
                        <div class="form-group">
                            <label class="form-label" for="ImageUrl">Image URL (Optional)</label>
                            <input type="url" class="form-input" id="ImageUrl" name="ImageUrl" value="{{ImageUrl}}"
                                placeholder="https://..." />
                        </div>
                    </div>

                    <div class="form-row full">
                        <div class="form-group">
                            <label class="form-label" for="TinyDes">Tiny Description *</label>
                            <textarea class="form-textarea wysiwyg-editor" id="TinyDes" name="TinyDes" rows="3"
                                required>{{TinyDes}}</textarea>
                        </div>
                    </div>
                    <div class="form-row full">
                        <div class="form-group">
                            <label class="form-label" for="FullDes">Full Description *</label>
                            <textarea class="form-textarea wysiwyg-editor" id="FullDes" name="FullDes" rows="6"
                                required>{{FullDes}}</textarea>
                        </div>
                    </div>

                    <div
                        style="text-align: center; margin-top: 30px; display: flex; justify-content: center; gap: 15px;">
                        <a href="/management/course" class="btn btn-secondary">
                            <i class="bi bi-arrow-left"></i> Cancel
                        </a>
                        <button type="submit" class="btn btn-primary">
                            üíæ Save Changed
                        </button>
                    </div>
                </form>
                {{/with}}
            </div>
        </section>
    </div>
</main>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        tinymce.init({
            selector: 'textarea.wysiwyg-editor', // Ch·ªçn t·∫•t c·∫£ textarea c√≥ class n√†y tr√™n trang edit
            plugins: 'anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount linkchecker',
            toolbar: 'undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table | align lineheight | numlist bullist indent outdent | emoticons charmap | removeformat',
            height: 300
        });
    });
</script>