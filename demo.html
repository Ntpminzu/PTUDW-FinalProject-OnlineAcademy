<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Slytherin Academy - Online Learning Platform</title>
    <script src="/_sdk/data_sdk.js"></script>
    <script src="/_sdk/element_sdk.js"></script>
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <link
      href="https://cdn.quilljs.com/1.3.6/quill.snow.css"
      rel="stylesheet" />
    <style>
      body {
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 0;
        background: linear-gradient(
          135deg,
          #0d4a2b 0%,
          #1a5c3a 50%,
          #2d7a4f 100%
        );
        color: #ffffff;
        min-height: 100%;
      }

      /* Slytherin Theme Colors */
      :root {
        --slytherin-green: #0d4a2b;
        --slytherin-silver: #c0c0c0;
        --slytherin-dark: #1a1a1a;
        --slytherin-light: #2d7a4f;
        --accent-gold: #d4af37;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 20px;
      }

      /* Header & Navigation */
      .header {
        background: linear-gradient(
          90deg,
          var(--slytherin-dark) 0%,
          var(--slytherin-green) 100%
        );
        padding: 15px 0;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .nav-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .logo {
        font-size: 2rem;
        font-weight: bold;
        color: var(--accent-gold);
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      }

      .nav-menu {
        display: flex;
        list-style: none;
        margin: 0;
        padding: 0;
        gap: 30px;
      }

      .nav-item {
        position: relative;
      }

      .nav-link {
        color: var(--slytherin-silver);
        text-decoration: none;
        padding: 10px 15px;
        border-radius: 8px;
        transition: all 0.3s ease;
        font-weight: 500;
      }

      .nav-link:hover {
        background: var(--slytherin-light);
        color: white;
        transform: translateY(-2px);
      }

      .dropdown {
        position: absolute;
        top: 100%;
        left: 0;
        background: var(--slytherin-dark);
        min-width: 200px;
        border-radius: 8px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        opacity: 0;
        visibility: hidden;
        transform: translateY(-10px);
        transition: all 0.3s ease;
      }

      .nav-item:hover .dropdown {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      .dropdown-item {
        display: block;
        padding: 12px 20px;
        color: var(--slytherin-silver);
        text-decoration: none;
        transition: all 0.3s ease;
      }

      .dropdown-item:hover {
        background: var(--slytherin-light);
        color: white;
      }

      .auth-buttons {
        display: flex;
        gap: 15px;
      }

      .btn {
        padding: 10px 20px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        text-decoration: none;
        display: inline-block;
        text-align: center;
      }

      .btn-primary {
        background: var(--accent-gold);
        color: var(--slytherin-dark);
      }

      .btn-primary:hover {
        background: #b8941f;
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
      }

      .btn-secondary {
        background: transparent;
        color: var(--slytherin-silver);
        border: 2px solid var(--slytherin-silver);
      }

      .btn-secondary:hover {
        background: var(--slytherin-silver);
        color: var(--slytherin-dark);
      }

      .btn-success {
        background: #27ae60;
        color: white;
      }

      .btn-success:hover {
        background: #219a52;
      }

      .btn-danger {
        background: #e74c3c;
        color: white;
      }

      .btn-danger:hover {
        background: #c0392b;
      }

      /* Hero Section */
      .hero {
        background: linear-gradient(
            135deg,
            rgba(13, 74, 43, 0.9),
            rgba(26, 92, 58, 0.9)
          ),
          url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 600"><defs><pattern id="snake" patternUnits="userSpaceOnUse" width="100" height="100"><path d="M20,20 Q50,10 80,20 Q50,30 20,20" stroke="%23d4af37" stroke-width="2" fill="none" opacity="0.1"/></pattern></defs><rect width="1000" height="600" fill="url(%23snake)"/></svg>');
        padding: 100px 0;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .hero::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(
          circle at 30% 70%,
          rgba(212, 175, 55, 0.1) 0%,
          transparent 50%
        );
      }

      .hero-content {
        position: relative;
        z-index: 2;
      }

      .hero h1 {
        font-size: 4rem;
        margin-bottom: 20px;
        text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
        color: var(--accent-gold);
      }

      .hero p {
        font-size: 1.3rem;
        margin-bottom: 40px;
        color: var(--slytherin-silver);
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
      }

      .search-container {
        max-width: 600px;
        margin: 0 auto;
        position: relative;
      }

      .search-input {
        width: 100%;
        padding: 15px 60px 15px 20px;
        border: none;
        border-radius: 50px;
        font-size: 1.1rem;
        background: rgba(255, 255, 255, 0.95);
        color: var(--slytherin-dark);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      }

      .search-btn {
        position: absolute;
        right: 5px;
        top: 50%;
        transform: translateY(-50%);
        background: var(--accent-gold);
        border: none;
        padding: 10px 20px;
        border-radius: 50px;
        cursor: pointer;
        color: var(--slytherin-dark);
        font-weight: bold;
      }

      /* Course Sections */
      .section {
        padding: 80px 0;
        position: relative;
      }

      .section-title {
        font-size: 2.5rem;
        text-align: center;
        margin-bottom: 50px;
        color: var(--accent-gold);
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      /* Slideshow for Featured Courses */
      .slideshow-container {
        position: relative;
        max-width: 100%;
        margin: auto;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }

      .slide {
        display: none;
        background: linear-gradient(
          135deg,
          var(--slytherin-dark),
          var(--slytherin-green)
        );
        padding: 60px;
        text-align: center;
        min-height: 400px;
        position: relative;
      }

      .slide.active {
        display: block;
      }

      .slide h3 {
        font-size: 2.5rem;
        color: var(--accent-gold);
        margin-bottom: 20px;
      }

      .slide p {
        font-size: 1.2rem;
        color: var(--slytherin-silver);
        margin-bottom: 30px;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
      }

      .slide-meta {
        display: flex;
        justify-content: center;
        gap: 30px;
        margin-bottom: 30px;
        flex-wrap: wrap;
      }

      .meta-badge {
        background: rgba(212, 175, 55, 0.2);
        padding: 8px 16px;
        border-radius: 20px;
        color: var(--accent-gold);
        font-weight: bold;
      }

      .prev,
      .next {
        cursor: pointer;
        position: absolute;
        top: 50%;
        width: auto;
        margin-top: -22px;
        padding: 16px;
        color: var(--accent-gold);
        font-weight: bold;
        font-size: 18px;
        transition: 0.3s ease;
        border-radius: 0 3px 3px 0;
        background: rgba(0, 0, 0, 0.5);
      }

      .next {
        right: 0;
        border-radius: 3px 0 0 3px;
      }

      .prev:hover,
      .next:hover {
        background: rgba(212, 175, 55, 0.8);
        color: var(--slytherin-dark);
      }

      .dots-container {
        text-align: center;
        margin-top: 20px;
      }

      .dot {
        cursor: pointer;
        height: 15px;
        width: 15px;
        margin: 0 5px;
        background-color: rgba(192, 192, 192, 0.5);
        border-radius: 50%;
        display: inline-block;
        transition: background-color 0.3s ease;
      }

      .dot.active,
      .dot:hover {
        background-color: var(--accent-gold);
      }

      /* Course Grid */
      .course-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
        margin-top: 50px;
      }

      .course-card {
        background: linear-gradient(
          135deg,
          var(--slytherin-dark),
          var(--slytherin-green)
        );
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
        position: relative;
      }

      .course-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
      }

      .course-image {
        height: 200px;
        background: linear-gradient(
          45deg,
          var(--slytherin-light),
          var(--accent-gold)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3rem;
        color: white;
        position: relative;
      }

      .course-badge {
        position: absolute;
        top: 15px;
        right: 15px;
        background: var(--accent-gold);
        color: var(--slytherin-dark);
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 0.8rem;
        font-weight: bold;
      }

      .course-content {
        padding: 25px;
      }

      .course-title {
        font-size: 1.3rem;
        font-weight: bold;
        color: var(--accent-gold);
        margin-bottom: 10px;
      }

      .course-category {
        color: var(--slytherin-silver);
        font-size: 0.9rem;
        margin-bottom: 15px;
      }

      .course-instructor {
        color: var(--slytherin-silver);
        margin-bottom: 15px;
      }

      .course-rating {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 15px;
      }

      .stars {
        color: var(--accent-gold);
      }

      .course-price {
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: bold;
      }

      .price-current {
        color: var(--accent-gold);
        font-size: 1.2rem;
      }

      .price-original {
        color: var(--slytherin-silver);
        text-decoration: line-through;
        font-size: 0.9rem;
      }

      /* Categories Section */
      .categories-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 25px;
        margin-top: 50px;
      }

      .category-card {
        background: linear-gradient(
          135deg,
          var(--slytherin-dark),
          var(--slytherin-light)
        );
        padding: 30px;
        border-radius: 15px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid transparent;
      }

      .category-card:hover {
        border-color: var(--accent-gold);
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(212, 175, 55, 0.2);
      }

      .category-icon {
        font-size: 3rem;
        margin-bottom: 20px;
        color: var(--accent-gold);
      }

      .category-name {
        font-size: 1.3rem;
        font-weight: bold;
        color: white;
        margin-bottom: 10px;
      }

      .category-count {
        color: var(--slytherin-silver);
        font-size: 0.9rem;
      }

      /* User Interface */
      .user-section {
        background: var(--slytherin-dark);
        padding: 60px 0;
        margin-top: 50px;
      }

      .user-tabs {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-bottom: 40px;
        flex-wrap: wrap;
      }

      .tab-btn {
        padding: 12px 25px;
        background: transparent;
        color: var(--slytherin-silver);
        border: 2px solid var(--slytherin-silver);
        border-radius: 25px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .tab-btn.active {
        background: var(--accent-gold);
        color: var(--slytherin-dark);
        border-color: var(--accent-gold);
      }

      .tab-content {
        display: none;
        max-width: 1000px;
        margin: 0 auto;
        background: var(--slytherin-green);
        padding: 40px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }

      .tab-content.active {
        display: block;
      }

      .form-group {
        margin-bottom: 25px;
      }

      .form-label {
        display: block;
        margin-bottom: 8px;
        color: var(--accent-gold);
        font-weight: 600;
      }

      .form-input,
      .form-select,
      .form-textarea {
        width: 100%;
        padding: 12px 15px;
        border: none;
        border-radius: 8px;
        background: rgba(255, 255, 255, 0.95);
        color: var(--slytherin-dark);
        font-size: 1rem;
        box-sizing: border-box;
      }

      .form-textarea {
        min-height: 120px;
        resize: vertical;
      }

      .form-input:focus,
      .form-select:focus,
      .form-textarea:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.3);
      }

      /* Course Form Styles */
      .course-form {
        background: var(--slytherin-dark);
        padding: 40px;
        border-radius: 15px;
        margin-top: 30px;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 25px;
      }

      .form-row.full {
        grid-template-columns: 1fr;
      }

      /* WYSIWYG Editor Styles */
      .editor-container {
        background: white;
        border-radius: 8px;
        overflow: hidden;
      }

      .ql-toolbar {
        border-top: none !important;
        border-left: none !important;
        border-right: none !important;
      }

      .ql-container {
        border-bottom: none !important;
        border-left: none !important;
        border-right: none !important;
        min-height: 200px;
      }

      /* Chapter Management */
      .chapter-list {
        background: var(--slytherin-green);
        border-radius: 10px;
        padding: 20px;
        margin-top: 20px;
      }

      .chapter-item {
        background: var(--slytherin-dark);
        padding: 15px 20px;
        border-radius: 8px;
        margin-bottom: 15px;
        display: flex;
        justify-content: between;
        align-items: center;
        gap: 15px;
      }

      .chapter-info {
        flex: 1;
      }

      .chapter-title {
        color: var(--accent-gold);
        font-weight: bold;
        margin-bottom: 5px;
      }

      .chapter-status {
        color: var(--slytherin-silver);
        font-size: 0.9rem;
      }

      .chapter-actions {
        display: flex;
        gap: 10px;
      }

      /* Video Upload */
      .video-upload {
        border: 2px dashed var(--accent-gold);
        border-radius: 10px;
        padding: 30px;
        text-align: center;
        background: rgba(212, 175, 55, 0.1);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .video-upload:hover {
        background: rgba(212, 175, 55, 0.2);
      }

      .video-upload.dragover {
        background: rgba(212, 175, 55, 0.3);
        border-color: #b8941f;
      }

      /* Admin Panel */
      .admin-panel {
        background: var(--slytherin-dark);
        padding: 40px;
        border-radius: 15px;
        margin-top: 40px;
      }

      .admin-tabs {
        display: flex;
        gap: 15px;
        margin-bottom: 30px;
        flex-wrap: wrap;
      }

      .admin-tab {
        padding: 10px 20px;
        background: var(--slytherin-green);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .admin-tab.active {
        background: var(--accent-gold);
        color: var(--slytherin-dark);
      }

      .data-table {
        width: 100%;
        border-collapse: collapse;
        background: var(--slytherin-green);
        border-radius: 10px;
        overflow: hidden;
      }

      .data-table th,
      .data-table td {
        padding: 15px;
        text-align: left;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .data-table th {
        background: var(--slytherin-dark);
        color: var(--accent-gold);
        font-weight: bold;
      }

      .data-table td {
        color: white;
      }

      .action-btn {
        padding: 5px 12px;
        margin: 0 3px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 0.8rem;
        transition: all 0.3s ease;
      }

      .btn-edit {
        background: #3498db;
        color: white;
      }

      .btn-delete {
        background: #e74c3c;
        color: white;
      }

      .btn-view {
        background: var(--accent-gold);
        color: var(--slytherin-dark);
      }

      /* Status Badges */
      .status-badge {
        padding: 4px 12px;
        border-radius: 15px;
        font-size: 0.8rem;
        font-weight: bold;
      }

      .status-draft {
        background: #f39c12;
        color: white;
      }

      .status-incomplete {
        background: #e67e22;
        color: white;
      }

      .status-completed {
        background: #27ae60;
        color: white;
      }

      .status-published {
        background: #2ecc71;
        color: white;
      }

      /* Loading States */
      .loading {
        text-align: center;
        padding: 40px;
        color: var(--slytherin-silver);
      }

      .spinner {
        border: 4px solid rgba(212, 175, 55, 0.3);
        border-radius: 50%;
        border-top: 4px solid var(--accent-gold);
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Modal Styles */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
      }

      .modal.show {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .modal-content {
        background: var(--slytherin-dark);
        padding: 30px;
        border-radius: 15px;
        max-width: 800px;
        width: 90%;
        max-height: 90%;
        overflow-y: auto;
        position: relative;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid var(--slytherin-green);
      }

      .modal-title {
        color: var(--accent-gold);
        font-size: 1.5rem;
        font-weight: bold;
      }

      .close-btn {
        background: none;
        border: none;
        color: var(--slytherin-silver);
        font-size: 1.5rem;
        cursor: pointer;
        padding: 5px;
      }

      .close-btn:hover {
        color: var(--accent-gold);
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .nav-menu {
          display: none;
        }

        .hero h1 {
          font-size: 2.5rem;
        }

        .course-grid {
          grid-template-columns: 1fr;
        }

        .slide {
          padding: 30px 20px;
        }

        .admin-tabs {
          flex-direction: column;
        }

        .form-row {
          grid-template-columns: 1fr;
        }

        .tab-content {
          padding: 20px;
        }
      }

      /* Pagination */
      .pagination {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 40px;
      }

      .page-btn {
        padding: 10px 15px;
        background: var(--slytherin-green);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .page-btn:hover,
      .page-btn.active {
        background: var(--accent-gold);
        color: var(--slytherin-dark);
      }

      /* Toast Messages */
      .toast {
        position: fixed;
        top: 20px;
        right: 20px;
        background: var(--accent-gold);
        color: var(--slytherin-dark);
        padding: 15px 25px;
        border-radius: 8px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        z-index: 1000;
        transform: translateX(400px);
        transition: transform 0.3s ease;
      }

      .toast.show {
        transform: translateX(0);
      }

      .toast.error {
        background: #e74c3c;
        color: white;
      }

      .toast.success {
        background: #27ae60;
        color: white;
      }

      /* Progress Bar */
      .progress-bar {
        width: 100%;
        height: 8px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 4px;
        overflow: hidden;
        margin: 10px 0;
      }

      .progress-fill {
        height: 100%;
        background: var(--accent-gold);
        transition: width 0.3s ease;
      }
    </style>
    <style>
      @view-transition {
        navigation: auto;
      }
    </style>
    <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="container">
        <nav class="nav-container">
          <div class="logo" id="academyName">🐍 Slytherin Academy</div>
          <ul class="nav-menu">
            <li class="nav-item">
              <a href="#" class="nav-link" onclick="showSection('home')"
                >Trang chủ</a
              >
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">Lĩnh vực</a>
              <div class="dropdown">
                <a
                  href="#"
                  class="dropdown-item"
                  onclick="showCoursesByCategory('IT', 'Lập trình Web')"
                  >🌐 Lập trình Web</a
                >
                <a
                  href="#"
                  class="dropdown-item"
                  onclick="showCoursesByCategory('IT', 'Lập trình thiết bị di động')"
                  >📱 Lập trình Mobile</a
                >
                <a
                  href="#"
                  class="dropdown-item"
                  onclick="showCoursesByCategory('Design', 'UI/UX Design')"
                  >🎨 UI/UX Design</a
                >
                <a
                  href="#"
                  class="dropdown-item"
                  onclick="showCoursesByCategory('Business', 'Marketing')"
                  >📈 Marketing</a
                >
              </div>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link" onclick="showSection('courses')"
                >Khóa học</a
              >
            </li>
            <li class="nav-item">
              <a
                href="#"
                class="nav-link"
                onclick="showSection('courseManagement')"
                >📚 Quản lý khóa học</a
              >
            </li>
            <li class="nav-item">
              <a
                href="#"
                class="nav-link"
                onclick="showSection('instructorManagement')"
                >👨‍🏫 Quản lý giảng viên</a
              >
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link" onclick="showSection('search')"
                >Tìm kiếm</a
              >
            </li>
          </ul>
          <div class="auth-buttons">
            <div id="guestButtons">
              <a
                href="#"
                class="btn btn-secondary"
                onclick="showSection('auth')"
                >Đăng nhập</a
              >
              <a href="#" class="btn btn-primary" onclick="showSection('auth')"
                >Đăng ký</a
              >
            </div>
            <div id="userButtons" style="display: none">
              <span id="welcomeUser" class="nav-link"></span>
              <a
                href="#"
                class="btn btn-secondary"
                onclick="showSection('profile')"
                >Hồ sơ</a
              >
              <a href="#" class="btn btn-primary" onclick="logout()"
                >Đăng xuất</a
              >
            </div>
          </div>
        </nav>
      </div>
    </header>
    <!-- Main Content -->
    <main>
      <!-- Home Section -->
      <section id="homeSection" class="section">
        <!-- Hero -->
        <div class="hero">
          <div class="container">
            <div class="hero-content">
              <h1 id="welcomeMessage">Chào mừng đến với Slytherin Academy</h1>
              <p>
                Nơi khơi nguồn tri thức và phát triển kỹ năng với những khóa học
                chất lượng cao từ các chuyên gia hàng đầu
              </p>
              <div class="search-container">
                <input
                  type="text"
                  class="search-input"
                  id="heroSearch"
                  placeholder="Tìm kiếm khóa học..." />
                <button class="search-btn" onclick="performSearch()">🔍</button>
              </div>
            </div>
          </div>
        </div>
        <div class="container">
          <!-- Featured Courses Slideshow -->
          <div class="section">
            <h2 class="section-title" id="featuredTitle">
              🌟 Khóa học nổi bật tuần này
            </h2>
            <div class="slideshow-container">
              <div class="slide active">
                <h3>🐍 Advanced Python Programming</h3>
                <p>
                  Nâng cao kỹ năng lập trình Python với các kỹ thuật advanced và
                  best practices từ các chuyên gia
                </p>
                <div class="slide-meta">
                  <span class="meta-badge">⭐ 4.9 (1,234 đánh giá)</span>
                  <span class="meta-badge">👥 5,678 học viên</span>
                  <span class="meta-badge">💰 1,299,000 VNĐ</span>
                </div>
                <a
                  href="#"
                  class="btn btn-primary"
                  onclick="showCourseDetail('python-advanced')"
                  >Xem chi tiết</a
                >
              </div>
              <div class="slide">
                <h3>⚡ React.js Mastery</h3>
                <p>
                  Trở thành chuyên gia React.js với khóa học toàn diện từ cơ bản
                  đến nâng cao
                </p>
                <div class="slide-meta">
                  <span class="meta-badge">⭐ 4.8 (987 đánh giá)</span>
                  <span class="meta-badge">👥 3,456 học viên</span>
                  <span class="meta-badge">💰 1,599,000 VNĐ</span>
                </div>
                <a
                  href="#"
                  class="btn btn-primary"
                  onclick="showCourseDetail('react-mastery')"
                  >Xem chi tiết</a
                >
              </div>
              <div class="slide">
                <h3>🎨 UI/UX Design Complete</h3>
                <p>
                  Khóa học thiết kế UI/UX hoàn chỉnh với các dự án thực tế và
                  portfolio chuyên nghiệp
                </p>
                <div class="slide-meta">
                  <span class="meta-badge">⭐ 4.7 (756 đánh giá)</span>
                  <span class="meta-badge">👥 2,345 học viên</span>
                  <span class="meta-badge">💰 1,799,000 VNĐ</span>
                </div>
                <a
                  href="#"
                  class="btn btn-primary"
                  onclick="showCourseDetail('uiux-complete')"
                  >Xem chi tiết</a
                >
              </div>
              <a class="prev" onclick="changeSlide(-1)">❮</a>
              <a class="next" onclick="changeSlide(1)">❯</a>
            </div>
            <div class="dots-container">
              <span class="dot active" onclick="currentSlide(1)"></span>
              <span class="dot" onclick="currentSlide(2)"></span>
              <span class="dot" onclick="currentSlide(3)"></span>
            </div>
          </div>
          <!-- Most Viewed Courses -->
          <div class="section">
            <h2 class="section-title">🔥 Khóa học được xem nhiều nhất</h2>
            <div class="course-grid" id="mostViewedCourses">
              <div class="loading">
                <div class="spinner"></div>
                <p>Đang tải khóa học...</p>
              </div>
            </div>
          </div>
          <!-- Newest Courses -->
          <div class="section">
            <h2 class="section-title">🆕 Khóa học mới nhất</h2>
            <div class="course-grid" id="newestCourses">
              <div class="loading">
                <div class="spinner"></div>
                <p>Đang tải khóa học...</p>
              </div>
            </div>
          </div>
          <!-- Popular Categories -->
          <div class="section">
            <h2 class="section-title">📚 Lĩnh vực phổ biến</h2>
            <div class="categories-grid">
              <div
                class="category-card"
                onclick="showCoursesByCategory('IT', 'Lập trình Web')">
                <div class="category-icon">🌐</div>
                <div class="category-name">Lập trình Web</div>
                <div class="category-count">245 khóa học</div>
              </div>
              <div
                class="category-card"
                onclick="showCoursesByCategory('IT', 'Lập trình thiết bị di động')">
                <div class="category-icon">📱</div>
                <div class="category-name">Lập trình Mobile</div>
                <div class="category-count">156 khóa học</div>
              </div>
              <div
                class="category-card"
                onclick="showCoursesByCategory('Design', 'UI/UX Design')">
                <div class="category-icon">🎨</div>
                <div class="category-name">UI/UX Design</div>
                <div class="category-count">89 khóa học</div>
              </div>
              <div
                class="category-card"
                onclick="showCoursesByCategory('Business', 'Marketing')">
                <div class="category-icon">📈</div>
                <div class="category-name">Marketing</div>
                <div class="category-count">134 khóa học</div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- Courses Section -->
      <section id="coursesSection" class="section" style="display: none">
        <div class="container">
          <h2 class="section-title">📚 Danh sách khóa học</h2>
          <div
            class="course-filters"
            style="margin-bottom: 30px; text-align: center">
            <select
              id="categoryFilter"
              class="form-input"
              style="width: auto; margin-right: 15px">
              <option value="">Tất cả lĩnh vực</option>
              <option value="IT">Công nghệ thông tin</option>
              <option value="Design">Thiết kế</option>
              <option value="Business">Kinh doanh</option>
              <option value="Marketing">Marketing</option>
            </select>
            <select id="sortFilter" class="form-input" style="width: auto">
              <option value="rating">Đánh giá cao nhất</option>
              <option value="price_asc">Giá tăng dần</option>
              <option value="newest">Mới nhất</option>
              <option value="popular">Phổ biến nhất</option>
            </select>
          </div>
          <div class="course-grid" id="allCourses">
            <div class="loading">
              <div class="spinner"></div>
              <p>Đang tải khóa học...</p>
            </div>
          </div>
          <div class="pagination" id="coursePagination"></div>
        </div>
      </section>
      <!-- Search Section -->
      <section id="searchSection" class="section" style="display: none">
        <div class="container">
          <h2 class="section-title">🔍 Tìm kiếm khóa học</h2>
          <div
            class="search-container"
            style="max-width: 800px; margin: 0 auto 40px">
            <input
              type="text"
              class="search-input"
              id="searchInput"
              placeholder="Nhập từ khóa tìm kiếm..." />
            <button class="search-btn" onclick="performAdvancedSearch()">
              Tìm kiếm
            </button>
          </div>
          <div
            class="search-filters"
            style="
              display: flex;
              justify-content: center;
              gap: 20px;
              margin-bottom: 40px;
              flex-wrap: wrap;
            ">
            <select id="searchCategory" class="form-input" style="width: auto">
              <option value="">Tất cả lĩnh vực</option>
              <option value="IT">Công nghệ thông tin</option>
              <option value="Design">Thiết kế</option>
              <option value="Business">Kinh doanh</option>
            </select>
            <select id="searchSort" class="form-input" style="width: auto">
              <option value="relevance">Liên quan nhất</option>
              <option value="rating">Đánh giá cao nhất</option>
              <option value="price_asc">Giá tăng dần</option>
              <option value="newest">Mới nhất</option>
            </select>
          </div>
          <div class="course-grid" id="searchResults">
            <div
              style="
                text-align: center;
                color: var(--slytherin-silver);
                padding: 60px;
              ">
              <h3>🔍 Nhập từ khóa để tìm kiếm khóa học</h3>
              <p>
                Sử dụng từ khóa liên quan đến tên khóa học hoặc lĩnh vực bạn
                quan tâm
              </p>
            </div>
          </div>
          <div class="pagination" id="searchPagination"></div>
        </div>
      </section>
      <!-- Course Detail Section -->
      <section id="courseDetailSection" class="section" style="display: none">
        <div class="container">
          <div id="courseDetailContent">
            <!-- Course detail will be loaded here -->
          </div>
        </div>
      </section>
      <!-- Auth Section -->
      <section
        id="authSection"
        class="section user-section"
        style="display: none">
        <div class="container">
          <h2 class="section-title">🔐 Đăng nhập / Đăng ký</h2>
          <div class="user-tabs">
            <button class="tab-btn active" onclick="switchTab('login')">
              Đăng nhập
            </button>
            <button class="tab-btn" onclick="switchTab('register')">
              Đăng ký
            </button>
          </div>
          <div id="loginTab" class="tab-content active">
            <h3
              style="
                text-align: center;
                color: var(--accent-gold);
                margin-bottom: 30px;
              ">
              Đăng nhập tài khoản
            </h3>
            <form onsubmit="handleLogin(event)">
              <div class="form-group">
                <label class="form-label" for="loginEmail">Email</label>
                <input
                  type="email"
                  class="form-input"
                  id="loginEmail"
                  required />
              </div>
              <div class="form-group">
                <label class="form-label" for="loginPassword">Mật khẩu</label>
                <input
                  type="password"
                  class="form-input"
                  id="loginPassword"
                  required />
              </div>
              <button type="submit" class="btn btn-primary" style="width: 100%">
                Đăng nhập
              </button>
            </form>
          </div>
          <div id="registerTab" class="tab-content">
            <h3
              style="
                text-align: center;
                color: var(--accent-gold);
                margin-bottom: 30px;
              ">
              Đăng ký tài khoản
            </h3>
            <form onsubmit="handleRegister(event)">
              <div class="form-group">
                <label class="form-label" for="registerName">Họ tên</label>
                <input
                  type="text"
                  class="form-input"
                  id="registerName"
                  required />
              </div>
              <div class="form-group">
                <label class="form-label" for="registerEmail">Email</label>
                <input
                  type="email"
                  class="form-input"
                  id="registerEmail"
                  required />
              </div>
              <div class="form-group">
                <label class="form-label" for="registerPassword"
                  >Mật khẩu</label
                >
                <input
                  type="password"
                  class="form-input"
                  id="registerPassword"
                  required />
              </div>
              <div class="form-group">
                <label class="form-label" for="registerUserType"
                  >Loại tài khoản</label
                >
                <select class="form-input" id="registerUserType" required>
                  <option value="student">Học viên</option>
                  <option value="instructor">Giảng viên</option>
                </select>
              </div>
              <button type="submit" class="btn btn-primary" style="width: 100%">
                Đăng ký
              </button>
            </form>
          </div>
        </div>
      </section>
      <!-- Course Management Section -->
      <section
        id="courseManagementSection"
        class="section user-section"
        style="display: none">
        <div class="container">
          <h2 class="section-title">📚 Quản lý khóa học</h2>
          <div class="user-tabs">
            <button class="tab-btn active" onclick="switchCourseTab('list')">
              Danh sách khóa học
            </button>
            <button class="tab-btn" onclick="switchCourseTab('add')">
              Thêm khóa học
            </button>
            <button class="tab-btn" onclick="switchCourseTab('categories')">
              Quản lý danh mục
            </button>
          </div>
          <div id="courseList" class="tab-content active">
            <div
              style="
                display: flex;
                justify-content: between;
                align-items: center;
                margin-bottom: 30px;
              ">
              <h3 style="color: var(--accent-gold)">📋 Tất cả khóa học</h3>
              <button class="btn btn-primary" onclick="showAddCourseForm()">
                ➕ Thêm khóa học mới
              </button>
            </div>
            <div class="course-filters" style="margin-bottom: 30px">
              <select
                id="adminCategoryFilter"
                class="form-input"
                style="width: auto; margin-right: 15px">
                <option value="">Tất cả lĩnh vực</option>
                <option value="IT">Công nghệ thông tin</option>
                <option value="Design">Thiết kế</option>
                <option value="Business">Kinh doanh</option>
                <option value="Marketing">Marketing</option>
              </select>
              <select
                id="adminStatusFilter"
                class="form-input"
                style="width: auto; margin-right: 15px">
                <option value="">Tất cả trạng thái</option>
                <option value="completed">Hoàn thành</option>
                <option value="incomplete">Chưa hoàn thành</option>
                <option value="draft">Bản nháp</option>
              </select>
              <input
                type="text"
                id="courseSearchInput"
                class="form-input"
                placeholder="Tìm kiếm khóa học..."
                style="width: 300px" />
            </div>
            <div id="adminCoursesList">
              <div class="loading">
                <div class="spinner"></div>
                <p>Đang tải danh sách khóa học...</p>
              </div>
            </div>
          </div>
          <div id="courseAdd" class="tab-content">
            <h3
              style="
                text-align: center;
                color: var(--accent-gold);
                margin-bottom: 30px;
              ">
              ➕ Thêm khóa học mới
            </h3>
            <div class="course-form">
              <form id="quickCourseForm" onsubmit="quickAddCourse(event)">
                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="quickCourseTitle"
                      >Tên khóa học *</label
                    >
                    <input
                      type="text"
                      class="form-input"
                      id="quickCourseTitle"
                      required />
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="quickCourseImage"
                      >Icon khóa học</label
                    >
                    <input
                      type="text"
                      class="form-input"
                      id="quickCourseImage"
                      placeholder="📚"
                      maxlength="2" />
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="quickCourseCategory"
                      >Lĩnh vực *</label
                    >
                    <select
                      class="form-select"
                      id="quickCourseCategory"
                      required
                      onchange="updateQuickSubcategories()">
                      <option value="">Chọn lĩnh vực</option>
                      <option value="IT">Công nghệ thông tin</option>
                      <option value="Design">Thiết kế</option>
                      <option value="Business">Kinh doanh</option>
                      <option value="Marketing">Marketing</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="quickCourseSubcategory"
                      >Chuyên ngành *</label
                    >
                    <select
                      class="form-select"
                      id="quickCourseSubcategory"
                      required>
                      <option value="">Chọn chuyên ngành</option>
                    </select>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="quickCoursePrice"
                      >Giá gốc (VNĐ) *</label
                    >
                    <input
                      type="number"
                      class="form-input"
                      id="quickCoursePrice"
                      min="0"
                      required />
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="quickCourseInstructor"
                      >Giảng viên *</label
                    >
                    <select
                      class="form-select"
                      id="quickCourseInstructor"
                      required>
                      <option value="">Chọn giảng viên</option>
                    </select>
                  </div>
                </div>
                <div class="form-row full">
                  <div class="form-group">
                    <label class="form-label" for="quickCourseDescription"
                      >Mô tả ngắn *</label
                    >
                    <textarea
                      class="form-textarea"
                      id="quickCourseDescription"
                      rows="3"
                      required
                      placeholder="Mô tả ngắn gọn về khóa học..."></textarea>
                  </div>
                </div>
                <div style="text-align: center; margin-top: 30px">
                  <button
                    type="submit"
                    class="btn btn-primary"
                    style="margin-right: 15px">
                    💾 Lưu khóa học
                  </button>
                  <button
                    type="button"
                    class="btn btn-secondary"
                    onclick="document.getElementById('quickCourseForm').reset()">
                    🔄 Làm mới
                  </button>
                </div>
              </form>
            </div>
          </div>
          <div id="courseCategories" class="tab-content">
            <h3
              style="
                text-align: center;
                color: var(--accent-gold);
                margin-bottom: 30px;
              ">
              🏷️ Quản lý danh mục
            </h3>
            <div
              style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 30px;
              ">
              <div
                class="category-card"
                style="background: var(--slytherin-dark); padding: 25px">
                <h4 style="color: var(--accent-gold); margin-bottom: 20px">
                  🌐 Công nghệ thông tin
                </h4>
                <div style="color: var(--slytherin-silver); line-height: 1.8">
                  <div>
                    • Lập trình Web (${allCourses.filter(c =&gt; c.subcategory
                    === 'Lập trình Web').length} khóa học)
                  </div>
                  <div>
                    • Lập trình thiết bị di động (${allCourses.filter(c =&gt;
                    c.subcategory === 'Lập trình thiết bị di động').length} khóa
                    học)
                  </div>
                  <div>
                    • Data Science (${allCourses.filter(c =&gt; c.subcategory
                    === 'Data Science').length} khóa học)
                  </div>
                  <div>
                    • DevOps (${allCourses.filter(c =&gt; c.subcategory ===
                    'DevOps').length} khóa học)
                  </div>
                  <div>
                    • Cybersecurity (${allCourses.filter(c =&gt; c.subcategory
                    === 'Cybersecurity').length} khóa học)
                  </div>
                </div>
              </div>
              <div
                class="category-card"
                style="background: var(--slytherin-dark); padding: 25px">
                <h4 style="color: var(--accent-gold); margin-bottom: 20px">
                  🎨 Thiết kế
                </h4>
                <div style="color: var(--slytherin-silver); line-height: 1.8">
                  <div>
                    • UI/UX Design (${allCourses.filter(c =&gt; c.subcategory
                    === 'UI/UX Design').length} khóa học)
                  </div>
                  <div>
                    • Graphic Design (${allCourses.filter(c =&gt; c.subcategory
                    === 'Graphic Design').length} khóa học)
                  </div>
                  <div>
                    • Web Design (${allCourses.filter(c =&gt; c.subcategory ===
                    'Web Design').length} khóa học)
                  </div>
                  <div>
                    • Motion Graphics (${allCourses.filter(c =&gt; c.subcategory
                    === 'Motion Graphics').length} khóa học)
                  </div>
                </div>
              </div>
              <div
                class="category-card"
                style="background: var(--slytherin-dark); padding: 25px">
                <h4 style="color: var(--accent-gold); margin-bottom: 20px">
                  💼 Kinh doanh
                </h4>
                <div style="color: var(--slytherin-silver); line-height: 1.8">
                  <div>
                    • Quản lý dự án (${allCourses.filter(c =&gt; c.subcategory
                    === 'Quản lý dự án').length} khóa học)
                  </div>
                  <div>
                    • Khởi nghiệp (${allCourses.filter(c =&gt; c.subcategory ===
                    'Khởi nghiệp').length} khóa học)
                  </div>
                  <div>
                    • Tài chính (${allCourses.filter(c =&gt; c.subcategory ===
                    'Tài chính').length} khóa học)
                  </div>
                  <div>
                    • Nhân sự (${allCourses.filter(c =&gt; c.subcategory ===
                    'Nhân sự').length} khóa học)
                  </div>
                </div>
              </div>
              <div
                class="category-card"
                style="background: var(--slytherin-dark); padding: 25px">
                <h4 style="color: var(--accent-gold); margin-bottom: 20px">
                  📈 Marketing
                </h4>
                <div style="color: var(--slytherin-silver); line-height: 1.8">
                  <div>
                    • Digital Marketing (${allCourses.filter(c =&gt;
                    c.subcategory === 'Digital Marketing').length} khóa học)
                  </div>
                  <div>
                    • Content Marketing (${allCourses.filter(c =&gt;
                    c.subcategory === 'Content Marketing').length} khóa học)
                  </div>
                  <div>
                    • SEO/SEM (${allCourses.filter(c =&gt; c.subcategory ===
                    'SEO/SEM').length} khóa học)
                  </div>
                  <div>
                    • Social Media (${allCourses.filter(c =&gt; c.subcategory
                    === 'Social Media').length} khóa học)
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- Instructor Management Section -->
      <section
        id="instructorManagementSection"
        class="section user-section"
        style="display: none">
        <div class="container">
          <h2 class="section-title">👨‍🏫 Quản lý giảng viên</h2>
          <div class="user-tabs">
            <button
              class="tab-btn active"
              onclick="switchInstructorTab('list')">
              Danh sách giảng viên
            </button>
            <button class="tab-btn" onclick="switchInstructorTab('profile')">
              Hồ sơ cá nhân
            </button>
            <button class="tab-btn" onclick="switchInstructorTab('courses')">
              Khóa học của tôi
            </button>
          </div>
          <div id="instructorList" class="tab-content active">
            <div
              style="
                display: flex;
                justify-content: between;
                align-items: center;
                margin-bottom: 30px;
              ">
              <h3 style="color: var(--accent-gold)">👥 Tất cả giảng viên</h3>
              <div style="display: flex; gap: 15px">
                <input
                  type="text"
                  id="instructorSearchInput"
                  class="form-input"
                  placeholder="Tìm kiếm giảng viên..."
                  style="width: 300px" />
                <select
                  id="instructorExperienceFilter"
                  class="form-input"
                  style="width: auto">
                  <option value="">Tất cả kinh nghiệm</option>
                  <option value="1-3">1-3 năm</option>
                  <option value="4-7">4-7 năm</option>
                  <option value="8+">8+ năm</option>
                </select>
              </div>
            </div>
            <div id="instructorsList">
              <div class="loading">
                <div class="spinner"></div>
                <p>Đang tải danh sách giảng viên...</p>
              </div>
            </div>
          </div>
          <div id="instructorProfile" class="tab-content">
            <h3
              style="
                text-align: center;
                color: var(--accent-gold);
                margin-bottom: 30px;
              ">
              👤 Hồ sơ giảng viên
            </h3>
            <div class="course-form">
              <form
                id="instructorProfileForm"
                onsubmit="updateInstructorProfile(event)">
                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="instructorName"
                      >Họ tên *</label
                    >
                    <input
                      type="text"
                      class="form-input"
                      id="instructorName"
                      required />
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="instructorEmail"
                      >Email *</label
                    >
                    <input
                      type="email"
                      class="form-input"
                      id="instructorEmail"
                      required />
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="instructorExperience"
                      >Kinh nghiệm (năm) *</label
                    >
                    <input
                      type="number"
                      class="form-input"
                      id="instructorExperience"
                      min="0"
                      required />
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="instructorAvatar"
                      >Avatar (emoji) *</label
                    >
                    <input
                      type="text"
                      class="form-input"
                      id="instructorAvatar"
                      maxlength="2"
                      required />
                  </div>
                </div>
                <div class="form-row full">
                  <div class="form-group">
                    <label class="form-label" for="instructorBio"
                      >Giới thiệu bản thân *</label
                    >
                    <textarea
                      class="form-textarea"
                      id="instructorBio"
                      rows="4"
                      required
                      placeholder="Chia sẻ về kinh nghiệm, chuyên môn và passion của bạn..."></textarea>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label class="form-label" for="instructorGithub"
                      >GitHub (tùy chọn)</label
                    >
                    <input
                      type="url"
                      class="form-input"
                      id="instructorGithub"
                      placeholder="https://github.com/username" />
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="instructorLinkedin"
                      >LinkedIn (tùy chọn)</label
                    >
                    <input
                      type="url"
                      class="form-input"
                      id="instructorLinkedin"
                      placeholder="https://linkedin.com/in/username" />
                  </div>
                </div>
                <div style="text-align: center; margin-top: 30px">
                  <button
                    type="submit"
                    class="btn btn-primary"
                    style="margin-right: 15px">
                    💾 Cập nhật hồ sơ
                  </button>
                  <button
                    type="button"
                    class="btn btn-secondary"
                    onclick="loadInstructorProfileData()">
                    🔄 Làm mới
                  </button>
                </div>
              </form>
            </div>
          </div>
          <div id="instructorCourses" class="tab-content">
            <div
              style="
                display: flex;
                justify-content: between;
                align-items: center;
                margin-bottom: 30px;
              ">
              <h3 style="color: var(--accent-gold)">📚 Khóa học của tôi</h3>
              <button class="btn btn-primary" onclick="showAddCourseForm()">
                ➕ Thêm khóa học mới
              </button>
            </div>
            <div id="myInstructorCourses">
              <div class="loading">
                <div class="spinner"></div>
                <p>Đang tải khóa học...</p>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- Profile Section -->
      <section
        id="profileSection"
        class="section user-section"
        style="display: none">
        <div class="container">
          <h2 class="section-title">👤 Hồ sơ cá nhân</h2>
          <div class="user-tabs">
            <button class="tab-btn active" onclick="switchProfileTab('info')">
              Thông tin
            </button>
            <button class="tab-btn" onclick="switchProfileTab('watchlist')">
              Yêu thích
            </button>
            <button class="tab-btn" onclick="switchProfileTab('enrolled')">
              Khóa học đã mua
            </button>
            <button
              class="tab-btn"
              id="adminTab"
              onclick="switchProfileTab('admin')"
              style="display: none">
              Quản trị
            </button>
          </div>
          <div id="profileInfo" class="tab-content active">
            <h3
              style="
                text-align: center;
                color: var(--accent-gold);
                margin-bottom: 30px;
              ">
              Cập nhật thông tin
            </h3>
            <form onsubmit="updateProfile(event)">
              <div class="form-row">
                <div class="form-group">
                  <label class="form-label" for="profileName">Họ tên</label>
                  <input type="text" class="form-input" id="profileName" />
                </div>
                <div class="form-group">
                  <label class="form-label" for="profileEmail">Email</label>
                  <input type="email" class="form-input" id="profileEmail" />
                </div>
              </div>
              <div class="form-row" id="instructorFields" style="display: none">
                <div class="form-group">
                  <label class="form-label" for="profileExperience"
                    >Kinh nghiệm (năm)</label
                  >
                  <input
                    type="number"
                    class="form-input"
                    id="profileExperience"
                    min="0" />
                </div>
                <div class="form-group">
                  <label class="form-label" for="profileAvatar"
                    >Avatar (emoji hoặc ký tự)</label
                  >
                  <input
                    type="text"
                    class="form-input"
                    id="profileAvatar"
                    maxlength="2" />
                </div>
              </div>
              <div class="form-row full" id="bioField" style="display: none">
                <div class="form-group">
                  <label class="form-label" for="profileBio"
                    >Giới thiệu bản thân</label
                  >
                  <textarea
                    class="form-textarea"
                    id="profileBio"
                    rows="4"
                    placeholder="Chia sẻ về kinh nghiệm và chuyên môn của bạn..."></textarea>
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label class="form-label" for="currentPassword"
                    >Mật khẩu hiện tại</label
                  >
                  <input
                    type="password"
                    class="form-input"
                    id="currentPassword" />
                </div>
                <div class="form-group">
                  <label class="form-label" for="newPassword"
                    >Mật khẩu mới (để trống nếu không đổi)</label
                  >
                  <input type="password" class="form-input" id="newPassword" />
                </div>
              </div>
              <button type="submit" class="btn btn-primary" style="width: 100%">
                Cập nhật
              </button>
            </form>
          </div>
          <div id="profileWatchlist" class="tab-content">
            <h3
              style="
                text-align: center;
                color: var(--accent-gold);
                margin-bottom: 30px;
              ">
              Danh sách yêu thích
            </h3>
            <div class="course-grid" id="watchlistCourses">
              <div class="loading">
                <div class="spinner"></div>
                <p>Đang tải danh sách yêu thích...</p>
              </div>
            </div>
          </div>
          <div id="profileEnrolled" class="tab-content">
            <h3
              style="
                text-align: center;
                color: var(--accent-gold);
                margin-bottom: 30px;
              ">
              Khóa học đã mua
            </h3>
            <div class="course-grid" id="enrolledCourses">
              <div class="loading">
                <div class="spinner"></div>
                <p>Đang tải khóa học đã mua...</p>
              </div>
            </div>
          </div>
          <div id="profileInstructor" class="tab-content">
            <h3
              style="
                text-align: center;
                color: var(--accent-gold);
                margin-bottom: 30px;
              ">
              Quản lý khóa học giảng dạy
            </h3>
            <div style="text-align: center; margin-bottom: 30px">
              <button class="btn btn-primary" onclick="showAddCourseForm()">
                ➕ Thêm khóa học mới
              </button>
            </div>
            <div id="instructorCourses">
              <div class="loading">
                <div class="spinner"></div>
                <p>Đang tải khóa học giảng dạy...</p>
              </div>
            </div>
          </div>
          <div id="profileAdmin" class="tab-content">
            <h3
              style="
                text-align: center;
                color: var(--accent-gold);
                margin-bottom: 30px;
              ">
              Quản trị hệ thống
            </h3>
            <div class="admin-panel">
              <div class="admin-tabs">
                <button
                  class="admin-tab active"
                  onclick="switchAdminTab('courses')">
                  Khóa học
                </button>
                <button class="admin-tab" onclick="switchAdminTab('users')">
                  Người dùng
                </button>
                <button
                  class="admin-tab"
                  onclick="switchAdminTab('categories')">
                  Lĩnh vực
                </button>
              </div>
              <div id="adminCourses" class="admin-content">
                <div class="loading">
                  <div class="spinner"></div>
                  <p>Đang tải dữ liệu...</p>
                </div>
              </div>
              <div id="adminUsers" class="admin-content" style="display: none">
                <div class="loading">
                  <div class="spinner"></div>
                  <p>Đang tải dữ liệu...</p>
                </div>
              </div>
              <div
                id="adminCategories"
                class="admin-content"
                style="display: none">
                <div class="loading">
                  <div class="spinner"></div>
                  <p>Đang tải dữ liệu...</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
    <!-- Course Form Modal -->
    <div id="courseModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title" id="courseModalTitle">Thêm khóa học mới</h2>
          <button class="close-btn" onclick="closeCourseModal()">×</button>
        </div>
        <form id="courseForm" onsubmit="saveCourse(event)">
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="courseTitle">Tên khóa học *</label>
              <input type="text" class="form-input" id="courseTitle" required />
            </div>
            <div class="form-group">
              <label class="form-label" for="courseImage">Icon khóa học</label>
              <input
                type="text"
                class="form-input"
                id="courseImage"
                placeholder="🐍"
                maxlength="2" />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="courseCategory">Lĩnh vực *</label>
              <select class="form-select" id="courseCategory" required>
                <option value="">Chọn lĩnh vực</option>
                <option value="IT">Công nghệ thông tin</option>
                <option value="Design">Thiết kế</option>
                <option value="Business">Kinh doanh</option>
                <option value="Marketing">Marketing</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label" for="courseSubcategory"
                >Chuyên ngành *</label
              >
              <select class="form-select" id="courseSubcategory" required>
                <option value="">Chọn chuyên ngành</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="coursePrice"
                >Giá gốc (VNĐ) *</label
              >
              <input
                type="number"
                class="form-input"
                id="coursePrice"
                min="0"
                required />
            </div>
            <div class="form-group">
              <label class="form-label" for="courseDiscountPrice"
                >Giá khuyến mãi (VNĐ)</label
              >
              <input
                type="number"
                class="form-input"
                id="courseDiscountPrice"
                min="0" />
            </div>
          </div>
          <div class="form-row full">
            <div class="form-group">
              <label class="form-label">Mô tả khóa học *</label>
              <div class="editor-container">
                <div id="courseDescriptionEditor"></div>
              </div>
            </div>
          </div>
          <div class="form-row full">
            <div class="form-group">
              <label class="form-label" for="courseRequirements"
                >Yêu cầu đầu vào</label
              >
              <textarea
                class="form-textarea"
                id="courseRequirements"
                rows="3"
                placeholder="Ví dụ: Kiến thức cơ bản về HTML, CSS..."></textarea>
            </div>
          </div>
          <div class="form-row full">
            <div class="form-group">
              <label class="form-label" for="courseWhatYouLearn"
                >Bạn sẽ học được gì</label
              >
              <textarea
                class="form-textarea"
                id="courseWhatYouLearn"
                rows="4"
                placeholder="Mỗi dòng một mục học được..."></textarea>
            </div>
          </div>
          <div class="form-row full">
            <div class="form-group">
              <label class="form-label" for="courseTargetAudience"
                >Đối tượng học viên</label
              >
              <textarea
                class="form-textarea"
                id="courseTargetAudience"
                rows="3"
                placeholder="Khóa học này phù hợp với..."></textarea>
            </div>
          </div>
          <div class="form-row full">
            <div class="form-group">
              <label class="form-label">Chương trình học</label>
              <div id="chaptersContainer">
                <div class="chapter-item">
                  <input
                    type="text"
                    class="form-input"
                    placeholder="Tên chương 1"
                    style="margin-bottom: 10px" />
                  <button
                    type="button"
                    class="btn btn-danger btn-sm"
                    onclick="removeChapter(this)">
                    Xóa
                  </button>
                </div>
              </div>
              <button
                type="button"
                class="btn btn-secondary"
                onclick="addChapter()">
                ➕ Thêm chương
              </button>
            </div>
          </div>
          <div
            style="
              display: flex;
              gap: 15px;
              justify-content: flex-end;
              margin-top: 30px;
            ">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeCourseModal()">
              Hủy
            </button>
            <button type="submit" class="btn btn-primary">Lưu khóa học</button>
          </div>
        </form>
      </div>
    </div>
    <!-- Chapter Detail Modal -->
    <div id="chapterModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title" id="chapterModalTitle">
            Chi tiết chương học
          </h2>
          <button class="close-btn" onclick="closeChapterModal()">×</button>
        </div>
        <div id="chapterContent">
          <!-- Chapter content will be loaded here -->
        </div>
      </div>
    </div>
    <script>
      // Global variables
      let currentUser = null;
      let currentSlideIndex = 0;
      let allCourses = [];
      let allUsers = [];
      let currentPage = 1;
      let currentEditingCourse = null;
      let descriptionEditor = null;
      const coursesPerPage = 9;

      // Default configuration
      const defaultConfig = {
        academy_name: "🐍 Slytherin Academy",
        welcome_message: "Chào mừng đến với Slytherin Academy",
        featured_title: "🌟 Khóa học nổi bật tuần này",
      };

      // Subcategory mapping
      const subcategoryMap = {
        IT: [
          "Lập trình Web",
          "Lập trình thiết bị di động",
          "Data Science",
          "DevOps",
          "Cybersecurity",
        ],
        Design: [
          "UI/UX Design",
          "Graphic Design",
          "Web Design",
          "Motion Graphics",
        ],
        Business: ["Quản lý dự án", "Khởi nghiệp", "Tài chính", "Nhân sự"],
        Marketing: [
          "Digital Marketing",
          "Content Marketing",
          "SEO/SEM",
          "Social Media",
        ],
      };

      // Data handler for SDK
      const dataHandler = {
        onDataChanged(data) {
          allCourses = data.filter((item) => item.type === "course");
          allUsers = data.filter((item) => item.type === "user");
          updateUI();
        },
      };

      // Initialize SDK
      async function initializeApp() {
        if (window.dataSdk) {
          const result = await window.dataSdk.init(dataHandler);
          if (result.isOk) {
            await seedInitialData();
          } else {
            console.error("Failed to initialize data SDK");
          }
        }

        // Initialize Element SDK
        if (window.elementSdk) {
          window.elementSdk.init({
            defaultConfig,
            render,
            mapToCapabilities,
            mapToEditPanelValues,
          });
        }

        // Initialize Quill editor
        initializeEditor();

        // Initial render
        render(defaultConfig);
      }

      // Initialize WYSIWYG Editor
      function initializeEditor() {
        if (typeof Quill !== "undefined") {
          descriptionEditor = new Quill("#courseDescriptionEditor", {
            theme: "snow",
            modules: {
              toolbar: [
                [{ header: [1, 2, 3, false] }],
                ["bold", "italic", "underline", "strike"],
                [{ list: "ordered" }, { list: "bullet" }],
                ["blockquote", "code-block"],
                ["link", "image"],
                ["clean"],
              ],
            },
            placeholder: "Nhập mô tả chi tiết về khóa học...",
          });
        }
      }

      // Render function for Element SDK
      async function render(config) {
        const academyName = config.academy_name || defaultConfig.academy_name;
        const welcomeMessage =
          config.welcome_message || defaultConfig.welcome_message;
        const featuredTitle =
          config.featured_title || defaultConfig.featured_title;

        document.getElementById("academyName").textContent = academyName;
        document.getElementById("welcomeMessage").textContent = welcomeMessage;
        document.getElementById("featuredTitle").textContent = featuredTitle;
      }

      // Capabilities mapping
      function mapToCapabilities(config) {
        return {
          recolorables: [],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined,
        };
      }

      // Edit panel values mapping
      function mapToEditPanelValues(config) {
        return new Map([
          ["academy_name", config.academy_name || defaultConfig.academy_name],
          [
            "welcome_message",
            config.welcome_message || defaultConfig.welcome_message,
          ],
          [
            "featured_title",
            config.featured_title || defaultConfig.featured_title,
          ],
        ]);
      }

      // Seed initial data
      async function seedInitialData() {
        // Check if data already exists
        if (allCourses.length > 0) return;

        const sampleCourses = [
          {
            id: "python-advanced",
            type: "course",
            title: "Advanced Python Programming",
            description:
              "Nâng cao kỹ năng lập trình Python với các kỹ thuật advanced và best practices từ các chuyên gia hàng đầu trong ngành.",
            category: "IT",
            subcategory: "Lập trình Web",
            instructor: "Nguyễn Văn Minh",
            instructor_id: "instructor_1",
            instructor_bio: "Senior Python Developer với 8+ năm kinh nghiệm",
            instructor_experience: "8",
            instructor_avatar: "🐍",
            rating: 4.9,
            reviews: 1234,
            students: 5678,
            price: 1299000,
            discount_price: 999000,
            image: "🐍",
            featured: true,
            bestseller: true,
            new: false,
            created_at: new Date().toISOString(),
            updated_at: new Date().toISOString(),
            status: "completed",
            chapters: JSON.stringify([
              "Giới thiệu Python Advanced",
              "Object-Oriented Programming",
              "Decorators và Generators",
              "Async Programming",
              "Testing và Debugging",
            ]),
            videos: JSON.stringify({
              "Giới thiệu Python Advanced": "completed",
              "Object-Oriented Programming": "completed",
              "Decorators và Generators": "completed",
              "Async Programming": "completed",
              "Testing và Debugging": "completed",
            }),
            requirements:
              "Kiến thức cơ bản về Python\nHiểu về lập trình hướng đối tượng",
            what_you_learn:
              "Nắm vững các kỹ thuật Python nâng cao\nXây dựng ứng dụng web với Django/Flask\nTối ưu hóa hiệu suất code\nViết test cases chuyên nghiệp",
            target_audience:
              "Lập trình viên Python có kinh nghiệm\nSinh viên IT muốn nâng cao kỹ năng\nDeveloper muốn chuyển sang Python",
          },
          {
            id: "react-mastery",
            type: "course",
            title: "React.js Mastery",
            description:
              "Trở thành chuyên gia React.js với khóa học toàn diện từ cơ bản đến nâng cao, bao gồm hooks, context, và các pattern hiện đại.",
            category: "IT",
            subcategory: "Lập trình Web",
            instructor: "Trần Thị Lan",
            instructor_id: "instructor_2",
            instructor_bio: "Frontend Architect tại công ty công nghệ hàng đầu",
            instructor_experience: "6",
            instructor_avatar: "⚡",
            rating: 4.8,
            reviews: 987,
            students: 3456,
            price: 1599000,
            discount_price: 1199000,
            image: "⚡",
            featured: true,
            bestseller: false,
            new: true,
            created_at: new Date().toISOString(),
            updated_at: new Date().toISOString(),
            status: "incomplete",
            chapters: JSON.stringify([
              "React Fundamentals",
              "Components và Props",
              "State Management",
              "React Hooks",
              "Advanced Patterns",
            ]),
            videos: JSON.stringify({
              "React Fundamentals": "completed",
              "Components và Props": "completed",
              "State Management": "pending",
              "React Hooks": "pending",
              "Advanced Patterns": "pending",
            }),
            requirements:
              "Kiến thức HTML, CSS, JavaScript\nHiểu về ES6+\nKinh nghiệm với npm/yarn",
            what_you_learn:
              "Xây dựng ứng dụng React từ đầu\nQuản lý state hiệu quả\nSử dụng hooks và context\nTối ưu hóa performance",
            target_audience:
              "Frontend developers\nSinh viên muốn học React\nDeveloper muốn cập nhật kỹ năng",
          },
          {
            id: "uiux-complete",
            type: "course",
            title: "UI/UX Design Complete",
            description:
              "Khóa học thiết kế UI/UX hoàn chỉnh với các dự án thực tế và portfolio chuyên nghiệp, từ research đến prototype.",
            category: "Design",
            subcategory: "UI/UX Design",
            instructor: "Lê Văn Đức",
            instructor_id: "instructor_3",
            instructor_bio: "Lead UX Designer với portfolio đa dạng",
            instructor_experience: "7",
            instructor_avatar: "🎨",
            rating: 4.7,
            reviews: 756,
            students: 2345,
            price: 1799000,
            discount_price: 1399000,
            image: "🎨",
            featured: true,
            bestseller: false,
            new: false,
            created_at: new Date().toISOString(),
            updated_at: new Date().toISOString(),
            status: "completed",
            chapters: JSON.stringify([
              "Design Thinking",
              "User Research",
              "Wireframing",
              "Prototyping",
              "Visual Design",
            ]),
            videos: JSON.stringify({
              "Design Thinking": "completed",
              "User Research": "completed",
              Wireframing: "completed",
              Prototyping: "completed",
              "Visual Design": "completed",
            }),
            requirements:
              "Không cần kinh nghiệm trước\nMáy tính có thể chạy Figma\nTinh thần học hỏi",
            what_you_learn:
              "Quy trình thiết kế UX hoàn chỉnh\nSử dụng Figma chuyên nghiệp\nTạo prototype tương tác\nXây dựng design system",
            target_audience:
              "Người mới bắt đầu với UX/UI\nGraphic designer muốn chuyển ngành\nProduct manager muốn hiểu design",
          },
        ];

        // Create sample instructor users
        const sampleUsers = [
          {
            id: "instructor_1",
            type: "user",
            user_name: "Nguyễn Văn Minh",
            user_email: "minh.instructor@academy.com",
            password: "123456",
            user_type: "instructor",
            bio: "Senior Python Developer với 8+ năm kinh nghiệm trong phát triển web và ứng dụng enterprise. Đã làm việc tại các công ty công nghệ hàng đầu và có passion trong việc chia sẻ kiến thức.",
            experience: "8",
            avatar: "🐍",
            social_links: JSON.stringify({
              github: "https://github.com/minhpython",
              linkedin: "https://linkedin.com/in/minhpython",
            }),
            watchlist: JSON.stringify([]),
            enrolled_courses: JSON.stringify([]),
            progress: JSON.stringify({}),
            created_at: new Date().toISOString(),
          },
          {
            id: "instructor_2",
            type: "user",
            user_name: "Trần Thị Lan",
            user_email: "lan.instructor@academy.com",
            password: "123456",
            user_type: "instructor",
            bio: "Frontend Architect với chuyên môn sâu về React.js và các công nghệ frontend hiện đại. Đã xây dựng nhiều ứng dụng web quy mô lớn và có kinh nghiệm mentoring team.",
            experience: "6",
            avatar: "⚡",
            social_links: JSON.stringify({
              github: "https://github.com/lanreact",
              linkedin: "https://linkedin.com/in/lanreact",
            }),
            watchlist: JSON.stringify([]),
            enrolled_courses: JSON.stringify([]),
            progress: JSON.stringify({}),
            created_at: new Date().toISOString(),
          },
          {
            id: "instructor_3",
            type: "user",
            user_name: "Lê Văn Đức",
            user_email: "duc.instructor@academy.com",
            password: "123456",
            user_type: "instructor",
            bio: "Lead UX Designer với portfolio đa dạng từ startup đến enterprise. Chuyên gia trong việc nghiên cứu người dùng và thiết kế trải nghiệm tối ưu.",
            experience: "7",
            avatar: "🎨",
            social_links: JSON.stringify({
              behance: "https://behance.net/ducux",
              linkedin: "https://linkedin.com/in/ducux",
            }),
            watchlist: JSON.stringify([]),
            enrolled_courses: JSON.stringify([]),
            progress: JSON.stringify({}),
            created_at: new Date().toISOString(),
          },
        ];

        // Create data
        for (const course of sampleCourses) {
          const result = await window.dataSdk.create(course);
          if (!result.isOk) {
            console.error("Failed to create course:", course.title);
          }
        }

        for (const user of sampleUsers) {
          const result = await window.dataSdk.create(user);
          if (!result.isOk) {
            console.error("Failed to create user:", user.user_name);
          }
        }
      }

      // Update UI based on data
      function updateUI() {
        updateMostViewedCourses();
        updateNewestCourses();
        updateAllCourses();

        if (currentUser && currentUser.user_type === "instructor") {
          loadInstructorCourses();
        }
      }

      // Update most viewed courses
      function updateMostViewedCourses() {
        const container = document.getElementById("mostViewedCourses");
        const mostViewed = allCourses
          .sort((a, b) => b.students - a.students)
          .slice(0, 6);

        container.innerHTML = mostViewed
          .map((course) => createCourseCard(course))
          .join("");
      }

      // Update newest courses
      function updateNewestCourses() {
        const container = document.getElementById("newestCourses");
        const newest = allCourses
          .sort((a, b) => new Date(b.created_at) - new Date(a.created_at))
          .slice(0, 6);

        container.innerHTML = newest
          .map((course) => createCourseCard(course))
          .join("");
      }

      // Update all courses
      function updateAllCourses() {
        const container = document.getElementById("allCourses");
        const startIndex = (currentPage - 1) * coursesPerPage;
        const endIndex = startIndex + coursesPerPage;
        const paginatedCourses = allCourses.slice(startIndex, endIndex);

        container.innerHTML = paginatedCourses
          .map((course) => createCourseCard(course))
          .join("");
        updatePagination("coursePagination", allCourses.length);
      }

      // Create course card HTML
      function createCourseCard(course) {
        const badge = course.bestseller
          ? "Best Seller"
          : course.new
          ? "Mới"
          : "";
        const badgeHtml = badge
          ? `<div class="course-badge">${badge}</div>`
          : "";

        // Status badge for instructor view
        let statusBadge = "";
        if (
          currentUser &&
          currentUser.user_type === "instructor" &&
          course.instructor_id === currentUser.id
        ) {
          const statusClass =
            course.status === "completed"
              ? "status-completed"
              : course.status === "incomplete"
              ? "status-incomplete"
              : "status-draft";
          const statusText =
            course.status === "completed"
              ? "Hoàn thành"
              : course.status === "incomplete"
              ? "Chưa hoàn thành"
              : "Bản nháp";
          statusBadge = `<div class="status-badge ${statusClass}">${statusText}</div>`;
        }

        return `
                <div class="course-card" onclick="showCourseDetail('${
                  course.id
                }')">
                    <div class="course-image">
                        ${badgeHtml}
                        ${statusBadge}
                        ${course.image}
                    </div>
                    <div class="course-content">
                        <div class="course-title">${course.title}</div>
                        <div class="course-category">${course.category} • ${
          course.subcategory
        }</div>
                        <div class="course-instructor">👨‍🏫 ${
                          course.instructor
                        }</div>
                        <div class="course-rating">
                            <span class="stars">${"⭐".repeat(
                              Math.floor(course.rating)
                            )}</span>
                            <span>${course.rating} (${
          course.reviews
        } đánh giá)</span>
                        </div>
                        <div class="course-price">
                            <span class="price-current">${formatPrice(
                              course.discount_price || course.price
                            )}</span>
                            ${
                              course.discount_price
                                ? `<span class="price-original">${formatPrice(
                                    course.price
                                  )}</span>`
                                : ""
                            }
                        </div>
                        ${
                          currentUser &&
                          currentUser.user_type === "instructor" &&
                          course.instructor_id === currentUser.id
                            ? `<div style="margin-top: 15px;">
                                <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation(); editCourse('${course.id}')" style="margin-right: 10px;">✏️ Sửa</button>
                                <button class="btn btn-primary btn-sm" onclick="event.stopPropagation(); manageCourseContent('${course.id}')">📚 Nội dung</button>
                            </div>`
                            : ""
                        }
                    </div>
                </div>
            `;
      }

      // Format price
      function formatPrice(price) {
        return new Intl.NumberFormat("vi-VN", {
          style: "currency",
          currency: "VND",
        }).format(price);
      }

      // Show section
      function showSection(sectionName) {
        // Hide all sections
        const sections = [
          "homeSection",
          "coursesSection",
          "searchSection",
          "courseDetailSection",
          "authSection",
          "profileSection",
          "courseManagementSection",
          "instructorManagementSection",
        ];
        sections.forEach((section) => {
          document.getElementById(section).style.display = "none";
        });

        // Show selected section
        document.getElementById(sectionName + "Section").style.display =
          "block";

        // Load section-specific data
        if (sectionName === "courses") {
          updateAllCourses();
        } else if (sectionName === "profile" && currentUser) {
          loadProfileData();
        } else if (sectionName === "courseManagement") {
          loadCourseManagement();
        } else if (sectionName === "instructorManagement") {
          loadInstructorManagement();
        }
      }

      // Course Management Functions
      function switchCourseTab(tabName) {
        document
          .querySelectorAll("#courseManagementSection .tab-btn")
          .forEach((btn) => btn.classList.remove("active"));
        document
          .querySelectorAll("#courseManagementSection .tab-content")
          .forEach((content) => content.classList.remove("active"));

        event.target.classList.add("active");
        document
          .getElementById(
            "course" + tabName.charAt(0).toUpperCase() + tabName.slice(1)
          )
          .classList.add("active");

        if (tabName === "list") {
          loadAdminCoursesList();
        } else if (tabName === "add") {
          loadInstructorOptions();
        } else if (tabName === "categories") {
          updateCategoryStats();
        }
      }

      function loadCourseManagement() {
        loadAdminCoursesList();
        loadInstructorOptions();
        updateCategoryStats();
      }

      function loadAdminCoursesList() {
        const container = document.getElementById("adminCoursesList");

        if (allCourses.length === 0) {
          container.innerHTML = `
                    <div style="text-align: center; color: var(--slytherin-silver); padding: 60px;">
                        <h3>📚 Chưa có khóa học nào</h3>
                        <p>Hãy thêm khóa học đầu tiên</p>
                    </div>
                `;
          return;
        }

        const courseCards = allCourses
          .map(
            (course) => `
                <div class="course-card" style="margin-bottom: 20px;">
                    <div class="course-image">
                        <div class="status-badge ${
                          course.status === "completed"
                            ? "status-completed"
                            : course.status === "incomplete"
                            ? "status-incomplete"
                            : "status-draft"
                        }">
                            ${
                              course.status === "completed"
                                ? "Hoàn thành"
                                : course.status === "incomplete"
                                ? "Chưa hoàn thành"
                                : "Bản nháp"
                            }
                        </div>
                        ${course.image}
                    </div>
                    <div class="course-content">
                        <div class="course-title">${course.title}</div>
                        <div class="course-category">${course.category} • ${
              course.subcategory
            }</div>
                        <div class="course-instructor">👨‍🏫 ${
                          course.instructor
                        }</div>
                        <div class="course-rating">
                            <span class="stars">${"⭐".repeat(
                              Math.floor(course.rating)
                            )}</span>
                            <span>${course.rating} (${
              course.reviews
            } đánh giá)</span>
                        </div>
                        <div class="course-price">
                            <span class="price-current">${formatPrice(
                              course.discount_price || course.price
                            )}</span>
                            ${
                              course.discount_price
                                ? `<span class="price-original">${formatPrice(
                                    course.price
                                  )}</span>`
                                : ""
                            }
                        </div>
                        <div style="margin-top: 15px; display: flex; gap: 10px;">
                            <button class="btn btn-secondary btn-sm" onclick="editCourse('${
                              course.id
                            }')">✏️ Sửa</button>
                            <button class="btn btn-primary btn-sm" onclick="showCourseDetail('${
                              course.id
                            }')">👁️ Xem</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteCourseConfirm('${
                              course.id
                            }')">🗑️ Xóa</button>
                        </div>
                    </div>
                </div>
            `
          )
          .join("");

        container.innerHTML = `<div class="course-grid">${courseCards}</div>`;
      }

      function loadInstructorOptions() {
        const instructors = allUsers.filter(
          (user) => user.user_type === "instructor"
        );
        const select = document.getElementById("quickCourseInstructor");

        select.innerHTML = '<option value="">Chọn giảng viên</option>';
        instructors.forEach((instructor) => {
          const option = document.createElement("option");
          option.value = instructor.id;
          option.textContent = `${instructor.avatar || "👨‍🏫"} ${
            instructor.user_name
          }`;
          select.appendChild(option);
        });
      }

      function updateQuickSubcategories() {
        const category = document.getElementById("quickCourseCategory").value;
        const subcategorySelect = document.getElementById(
          "quickCourseSubcategory"
        );

        subcategorySelect.innerHTML =
          '<option value="">Chọn chuyên ngành</option>';

        if (category && subcategoryMap[category]) {
          subcategoryMap[category].forEach((sub) => {
            const option = document.createElement("option");
            option.value = sub;
            option.textContent = sub;
            subcategorySelect.appendChild(option);
          });
        }
      }

      async function quickAddCourse(event) {
        event.preventDefault();

        // Check course limit
        if (allCourses.length >= 999) {
          showToast("Đã đạt giới hạn tối đa 999 khóa học!", "error");
          return;
        }

        const title = document.getElementById("quickCourseTitle").value;
        const image = document.getElementById("quickCourseImage").value || "📚";
        const category = document.getElementById("quickCourseCategory").value;
        const subcategory = document.getElementById(
          "quickCourseSubcategory"
        ).value;
        const price = parseInt(
          document.getElementById("quickCoursePrice").value
        );
        const instructorId = document.getElementById(
          "quickCourseInstructor"
        ).value;
        const description = document.getElementById(
          "quickCourseDescription"
        ).value;

        const instructor = allUsers.find((u) => u.id === instructorId);
        if (!instructor) {
          showToast("Vui lòng chọn giảng viên!", "error");
          return;
        }

        const newCourse = {
          id: "course_" + Date.now(),
          type: "course",
          title,
          description,
          category,
          subcategory,
          instructor: instructor.user_name,
          instructor_id: instructorId,
          instructor_bio: instructor.bio || "",
          instructor_experience: instructor.experience || "1",
          instructor_avatar: instructor.avatar || "👨‍🏫",
          rating: 0,
          reviews: 0,
          students: 0,
          price,
          discount_price: null,
          image,
          featured: false,
          bestseller: false,
          new: true,
          status: "draft",
          chapters: JSON.stringify(["Chương 1: Giới thiệu"]),
          videos: JSON.stringify({ "Chương 1: Giới thiệu": "pending" }),
          requirements: "",
          what_you_learn: "",
          target_audience: "",
          created_at: new Date().toISOString(),
          updated_at: new Date().toISOString(),
        };

        const result = await window.dataSdk.create(newCourse);
        if (result.isOk) {
          showToast("Tạo khóa học thành công!", "success");
          document.getElementById("quickCourseForm").reset();
          loadAdminCoursesList();
          updateCategoryStats();
        } else {
          showToast("Tạo khóa học thất bại!", "error");
        }
      }

      function updateCategoryStats() {
        // This will be called when the categories tab is active
        // The template literals in the HTML will automatically update with current data
      }

      async function deleteCourseConfirm(courseId) {
        const course = allCourses.find((c) => c.id === courseId);
        if (!course) return;

        // Create inline confirmation
        const courseCard = event.target.closest(".course-card");
        const originalContent = courseCard.innerHTML;

        courseCard.innerHTML = `
                <div style="padding: 20px; text-align: center; background: var(--slytherin-dark); border-radius: 10px;">
                    <h4 style="color: var(--accent-gold); margin-bottom: 15px;">⚠️ Xác nhận xóa</h4>
                    <p style="color: var(--slytherin-silver); margin-bottom: 20px;">
                        Bạn có chắc chắn muốn xóa khóa học "${
                          course.title
                        }"?<br>
                        Hành động này không thể hoàn tác.
                    </p>
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button class="btn btn-danger" onclick="confirmDeleteCourse('${courseId}')">🗑️ Xóa</button>
                        <button class="btn btn-secondary" onclick="cancelDeleteCourse(this, \`${originalContent.replace(
                          /`/g,
                          "\\`"
                        )}\`)">❌ Hủy</button>
                    </div>
                </div>
            `;
      }

      async function confirmDeleteCourse(courseId) {
        const course = allCourses.find((c) => c.id === courseId);
        if (course) {
          const result = await window.dataSdk.delete(course);
          if (result.isOk) {
            showToast("Xóa khóa học thành công!", "success");
            loadAdminCoursesList();
            updateCategoryStats();
          } else {
            showToast("Xóa khóa học thất bại!", "error");
          }
        }
      }

      function cancelDeleteCourse(button, originalContent) {
        const courseCard = button.closest(".course-card");
        courseCard.innerHTML = originalContent;
      }

      // Instructor Management Functions
      function switchInstructorTab(tabName) {
        document
          .querySelectorAll("#instructorManagementSection .tab-btn")
          .forEach((btn) => btn.classList.remove("active"));
        document
          .querySelectorAll("#instructorManagementSection .tab-content")
          .forEach((content) => content.classList.remove("active"));

        event.target.classList.add("active");
        document
          .getElementById(
            "instructor" + tabName.charAt(0).toUpperCase() + tabName.slice(1)
          )
          .classList.add("active");

        if (tabName === "list") {
          loadInstructorsList();
        } else if (tabName === "profile") {
          loadInstructorProfileData();
        } else if (tabName === "courses") {
          loadMyInstructorCourses();
        }
      }

      function loadInstructorManagement() {
        loadInstructorsList();
        if (currentUser && currentUser.user_type === "instructor") {
          loadInstructorProfileData();
          loadMyInstructorCourses();
        }
      }

      function loadInstructorsList() {
        const instructors = allUsers.filter(
          (user) => user.user_type === "instructor"
        );
        const container = document.getElementById("instructorsList");

        if (instructors.length === 0) {
          container.innerHTML = `
                    <div style="text-align: center; color: var(--slytherin-silver); padding: 60px;">
                        <h3>👨‍🏫 Chưa có giảng viên nào</h3>
                        <p>Hãy đăng ký tài khoản giảng viên để bắt đầu</p>
                    </div>
                `;
          return;
        }

        const instructorCards = instructors
          .map((instructor) => {
            const instructorCourses = allCourses.filter(
              (c) => c.instructor_id === instructor.id
            );
            const totalStudents = instructorCourses.reduce(
              (sum, c) => sum + c.students,
              0
            );
            const avgRating =
              instructorCourses.length > 0
                ? (
                    instructorCourses.reduce((sum, c) => sum + c.rating, 0) /
                    instructorCourses.length
                  ).toFixed(1)
                : 0;

            return `
                    <div class="course-card" style="margin-bottom: 20px;">
                        <div class="course-image" style="background: linear-gradient(45deg, var(--slytherin-light), var(--accent-gold));">
                            <div style="font-size: 4rem;">${
                              instructor.avatar || "👨‍🏫"
                            }</div>
                        </div>
                        <div class="course-content">
                            <div class="course-title">${
                              instructor.user_name
                            }</div>
                            <div class="course-category">📧 ${
                              instructor.user_email
                            }</div>
                            <div class="course-instructor">🎯 ${
                              instructor.experience || "1"
                            }+ năm kinh nghiệm</div>
                            <div class="course-rating">
                                <span class="stars">${"⭐".repeat(
                                  Math.floor(avgRating)
                                )}</span>
                                <span>${avgRating} • ${
              instructorCourses.length
            } khóa học</span>
                            </div>
                            <div style="color: var(--slytherin-silver); margin: 10px 0; font-size: 0.9rem;">
                                👥 ${totalStudents} học viên
                            </div>
                            <div style="color: var(--slytherin-silver); font-size: 0.9rem; line-height: 1.4;">
                                ${(
                                  instructor.bio ||
                                  "Chưa có thông tin giới thiệu"
                                ).substring(0, 100)}${
              instructor.bio && instructor.bio.length > 100 ? "..." : ""
            }
                            </div>
                            <div style="margin-top: 15px;">
                                <button class="btn btn-primary btn-sm" onclick="viewInstructorDetail('${
                                  instructor.id
                                }')">👁️ Xem chi tiết</button>
                            </div>
                        </div>
                    </div>
                `;
          })
          .join("");

        container.innerHTML = `<div class="course-grid">${instructorCards}</div>`;
      }

      function viewInstructorDetail(instructorId) {
        const instructor = allUsers.find((u) => u.id === instructorId);
        if (!instructor) return;

        const instructorCourses = allCourses.filter(
          (c) => c.instructor_id === instructorId
        );
        const totalStudents = instructorCourses.reduce(
          (sum, c) => sum + c.students,
          0
        );
        const avgRating =
          instructorCourses.length > 0
            ? (
                instructorCourses.reduce((sum, c) => sum + c.rating, 0) /
                instructorCourses.length
              ).toFixed(1)
            : 0;

        const detailHtml = `
                <div style="text-align: center; margin-bottom: 40px;">
                    <div style="width: 120px; height: 120px; border-radius: 50%; background: linear-gradient(45deg, var(--slytherin-light), var(--accent-gold)); margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; font-size: 4rem;">
                        ${instructor.avatar || "👨‍🏫"}
                    </div>
                    <h2 style="color: var(--accent-gold); margin-bottom: 10px;">${
                      instructor.user_name
                    }</h2>
                    <div style="color: var(--slytherin-silver); margin-bottom: 20px;">
                        📧 ${instructor.user_email} • 🎯 ${
          instructor.experience || "1"
        }+ năm kinh nghiệm
                    </div>
                    <div style="display: flex; justify-content: center; gap: 30px; margin-bottom: 20px;">
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--accent-gold);">${
                              instructorCourses.length
                            }</div>
                            <div style="color: var(--slytherin-silver); font-size: 0.9rem;">Khóa học</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--accent-gold);">${totalStudents}</div>
                            <div style="color: var(--slytherin-silver); font-size: 0.9rem;">Học viên</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--accent-gold);">${avgRating}</div>
                            <div style="color: var(--slytherin-silver); font-size: 0.9rem;">Đánh giá</div>
                        </div>
                    </div>
                </div>

                <div style="background: var(--slytherin-dark); padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                    <h3 style="color: var(--accent-gold); margin-bottom: 20px;">📝 Giới thiệu</h3>
                    <p style="color: var(--slytherin-silver); line-height: 1.8;">
                        ${
                          instructor.bio ||
                          "Giảng viên chưa cập nhật thông tin giới thiệu."
                        }
                    </p>
                </div>

                ${
                  instructorCourses.length > 0
                    ? `
                    <div style="background: var(--slytherin-dark); padding: 30px; border-radius: 15px;">
                        <h3 style="color: var(--accent-gold); margin-bottom: 20px;">📚 Khóa học giảng dạy</h3>
                        <div class="course-grid">
                            ${instructorCourses
                              .map((course) => createCourseCard(course))
                              .join("")}
                        </div>
                    </div>
                `
                    : `
                    <div style="text-align: center; color: var(--slytherin-silver); padding: 40px;">
                        <h3>📚 Chưa có khóa học nào</h3>
                        <p>Giảng viên chưa tạo khóa học nào</p>
                    </div>
                `
                }
            `;

        document.getElementById("chapterContent").innerHTML = detailHtml;
        document.getElementById(
          "chapterModalTitle"
        ).textContent = `Hồ sơ: ${instructor.user_name}`;
        document.getElementById("chapterModal").classList.add("show");
      }

      function loadInstructorProfileData() {
        if (!currentUser || currentUser.user_type !== "instructor") return;

        document.getElementById("instructorName").value =
          currentUser.user_name || "";
        document.getElementById("instructorEmail").value =
          currentUser.user_email || "";
        document.getElementById("instructorExperience").value =
          currentUser.experience || "";
        document.getElementById("instructorAvatar").value =
          currentUser.avatar || "";
        document.getElementById("instructorBio").value = currentUser.bio || "";

        const socialLinks = JSON.parse(currentUser.social_links || "{}");
        document.getElementById("instructorGithub").value =
          socialLinks.github || "";
        document.getElementById("instructorLinkedin").value =
          socialLinks.linkedin || "";
      }

      async function updateInstructorProfile(event) {
        event.preventDefault();

        if (!currentUser || currentUser.user_type !== "instructor") {
          showToast("Chỉ giảng viên mới có thể cập nhật hồ sơ!", "error");
          return;
        }

        const socialLinks = {
          github: document.getElementById("instructorGithub").value,
          linkedin: document.getElementById("instructorLinkedin").value,
        };

        const updatedUser = {
          ...currentUser,
          user_name: document.getElementById("instructorName").value,
          user_email: document.getElementById("instructorEmail").value,
          experience: document.getElementById("instructorExperience").value,
          avatar: document.getElementById("instructorAvatar").value,
          bio: document.getElementById("instructorBio").value,
          social_links: JSON.stringify(socialLinks),
        };

        const result = await window.dataSdk.update(updatedUser);
        if (result.isOk) {
          currentUser = updatedUser;
          updateAuthUI();
          showToast("Cập nhật hồ sơ thành công!", "success");
          loadInstructorsList(); // Refresh instructor list
        } else {
          showToast("Cập nhật hồ sơ thất bại!", "error");
        }
      }

      function loadMyInstructorCourses() {
        if (!currentUser || currentUser.user_type !== "instructor") return;

        const instructorCourses = allCourses.filter(
          (course) => course.instructor_id === currentUser.id
        );
        const container = document.getElementById("myInstructorCourses");

        if (instructorCourses.length === 0) {
          container.innerHTML = `
                    <div style="text-align: center; color: var(--slytherin-silver); padding: 60px;">
                        <h3>📚 Chưa có khóa học nào</h3>
                        <p>Hãy tạo khóa học đầu tiên của bạn</p>
                        <button class="btn btn-primary" onclick="showAddCourseForm()">➕ Tạo khóa học mới</button>
                    </div>
                `;
        } else {
          const stats = `
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
                        <div style="background: var(--slytherin-green); padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2rem; color: var(--accent-gold); margin-bottom: 10px;">📚</div>
                            <div style="font-size: 1.5rem; font-weight: bold; color: white;">${
                              instructorCourses.length
                            }</div>
                            <div style="color: var(--slytherin-silver); font-size: 0.9rem;">Tổng khóa học</div>
                        </div>
                        <div style="background: var(--slytherin-green); padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2rem; color: var(--accent-gold); margin-bottom: 10px;">✅</div>
                            <div style="font-size: 1.5rem; font-weight: bold; color: white;">${
                              instructorCourses.filter(
                                (c) => c.status === "completed"
                              ).length
                            }</div>
                            <div style="color: var(--slytherin-silver); font-size: 0.9rem;">Đã hoàn thành</div>
                        </div>
                        <div style="background: var(--slytherin-green); padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2rem; color: var(--accent-gold); margin-bottom: 10px;">👥</div>
                            <div style="font-size: 1.5rem; font-weight: bold; color: white;">${instructorCourses.reduce(
                              (sum, c) => sum + c.students,
                              0
                            )}</div>
                            <div style="color: var(--slytherin-silver); font-size: 0.9rem;">Tổng học viên</div>
                        </div>
                        <div style="background: var(--slytherin-green); padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2rem; color: var(--accent-gold); margin-bottom: 10px;">⭐</div>
                            <div style="font-size: 1.5rem; font-weight: bold; color: white;">${
                              instructorCourses.length > 0
                                ? (
                                    instructorCourses.reduce(
                                      (sum, c) => sum + c.rating,
                                      0
                                    ) / instructorCourses.length
                                  ).toFixed(1)
                                : 0
                            }</div>
                            <div style="color: var(--slytherin-silver); font-size: 0.9rem;">Đánh giá TB</div>
                        </div>
                    </div>
                `;

          container.innerHTML =
            stats +
            `<div class="course-grid">${instructorCourses
              .map((course) => createCourseCard(course))
              .join("")}</div>`;
        }
      }

      // Slideshow functionality
      function changeSlide(direction) {
        const slides = document.querySelectorAll(".slide");
        const dots = document.querySelectorAll(".dot");

        slides[currentSlideIndex].classList.remove("active");
        dots[currentSlideIndex].classList.remove("active");

        currentSlideIndex += direction;

        if (currentSlideIndex >= slides.length) {
          currentSlideIndex = 0;
        } else if (currentSlideIndex < 0) {
          currentSlideIndex = slides.length - 1;
        }

        slides[currentSlideIndex].classList.add("active");
        dots[currentSlideIndex].classList.add("active");
      }

      function currentSlide(index) {
        const slides = document.querySelectorAll(".slide");
        const dots = document.querySelectorAll(".dot");

        slides[currentSlideIndex].classList.remove("active");
        dots[currentSlideIndex].classList.remove("active");

        currentSlideIndex = index - 1;

        slides[currentSlideIndex].classList.add("active");
        dots[currentSlideIndex].classList.add("active");
      }

      // Auto slideshow
      setInterval(() => {
        changeSlide(1);
      }, 5000);

      // Search functionality
      function performSearch() {
        const query = document.getElementById("heroSearch").value;
        if (query.trim()) {
          document.getElementById("searchInput").value = query;
          showSection("search");
          performAdvancedSearch();
        }
      }

      function performAdvancedSearch() {
        const query = document
          .getElementById("searchInput")
          .value.toLowerCase();
        const category = document.getElementById("searchCategory").value;
        const sort = document.getElementById("searchSort").value;

        let results = allCourses.filter((course) => {
          const matchesQuery =
            !query ||
            course.title.toLowerCase().includes(query) ||
            course.description.toLowerCase().includes(query) ||
            course.category.toLowerCase().includes(query) ||
            course.subcategory.toLowerCase().includes(query);

          const matchesCategory = !category || course.category === category;

          return matchesQuery && matchesCategory;
        });

        // Sort results
        switch (sort) {
          case "rating":
            results.sort((a, b) => b.rating - a.rating);
            break;
          case "price_asc":
            results.sort(
              (a, b) =>
                (a.discount_price || a.price) - (b.discount_price || b.price)
            );
            break;
          case "newest":
            results.sort(
              (a, b) => new Date(b.created_at) - new Date(a.created_at)
            );
            break;
          default:
            // Keep relevance order
            break;
        }

        const container = document.getElementById("searchResults");
        if (results.length === 0) {
          container.innerHTML = `
                    <div style="text-align: center; color: var(--slytherin-silver); padding: 60px;">
                        <h3>😔 Không tìm thấy khóa học nào</h3>
                        <p>Thử sử dụng từ khóa khác hoặc chọn lĩnh vực khác</p>
                    </div>
                `;
        } else {
          container.innerHTML = results
            .map((course) => createCourseCard(course))
            .join("");
        }
      }

      // Show courses by category
      function showCoursesByCategory(category, subcategory) {
        showSection("courses");
        document.getElementById("categoryFilter").value = category;

        const filtered = allCourses.filter(
          (course) =>
            course.category === category &&
            (!subcategory || course.subcategory === subcategory)
        );

        const container = document.getElementById("allCourses");
        container.innerHTML = filtered
          .map((course) => createCourseCard(course))
          .join("");
      }

      // Show course detail
      function showCourseDetail(courseId) {
        const course = allCourses.find((c) => c.id === courseId);
        if (!course) return;

        const chapters = JSON.parse(course.chapters || "[]");
        const videos = JSON.parse(course.videos || "{}");
        const relatedCourses = allCourses
          .filter((c) => c.category === course.category && c.id !== courseId)
          .slice(0, 5);

        // Get instructor info
        const instructor =
          allUsers.find((u) => u.id === course.instructor_id) || {};
        const instructorBio =
          instructor.bio ||
          course.instructor_bio ||
          "Giảng viên có kinh nghiệm trong lĩnh vực này.";
        const instructorExperience =
          instructor.experience || course.instructor_experience || "5+";
        const instructorAvatar =
          instructor.avatar || course.instructor_avatar || course.image;

        const detailHtml = `
                <div class="course-header" style="display: grid; grid-template-columns: 300px 1fr; gap: 30px; margin-bottom: 40px; padding: 30px; background: linear-gradient(135deg, var(--slytherin-dark), var(--slytherin-green)); border-radius: 15px;">
                    <div class="course-image" style="width: 100%; height: 200px; background: linear-gradient(45deg, var(--slytherin-light), var(--accent-gold)); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 4rem;">
                        ${course.image}
                    </div>
                    <div class="course-info">
                        <h1 style="font-size: 2.5rem; color: var(--accent-gold); margin: 0 0 15px 0;">${
                          course.title
                        }</h1>
                        <p style="color: var(--slytherin-silver); font-size: 1.1rem; margin-bottom: 20px;">${
                          course.description
                        }</p>
                        <div style="display: flex; gap: 20px; margin: 15px 0; flex-wrap: wrap;">
                            <div style="background: rgba(212, 175, 55, 0.2); padding: 8px 15px; border-radius: 20px; color: var(--accent-gold);">
                                ⭐ ${course.rating} (${course.reviews} đánh giá)
                            </div>
                            <div style="background: rgba(212, 175, 55, 0.2); padding: 8px 15px; border-radius: 20px; color: var(--accent-gold);">
                                👥 ${course.students} học viên
                            </div>
                            <div style="background: rgba(212, 175, 55, 0.2); padding: 8px 15px; border-radius: 20px; color: var(--accent-gold);">
                                🔄 Cập nhật: ${new Date(
                                  course.updated_at
                                ).toLocaleDateString("vi-VN")}
                            </div>
                        </div>
                        <div style="display: flex; gap: 15px; align-items: center; margin-top: 20px;">
                            <span style="color: var(--accent-gold); font-size: 1.5rem; font-weight: bold;">${formatPrice(
                              course.discount_price || course.price
                            )}</span>
                            ${
                              course.discount_price
                                ? `<span style="color: var(--slytherin-silver); text-decoration: line-through;">${formatPrice(
                                    course.price
                                  )}</span>`
                                : ""
                            }
                            <button class="btn btn-primary" onclick="enrollInCourse('${
                              course.id
                            }')" style="margin-left: auto;">🚀 Đăng ký học</button>
                            <button class="btn btn-secondary" onclick="toggleWatchlist('${
                              course.id
                            }')">❤️ Yêu thích</button>
                        </div>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 40px;">
                    <div>
                        <div style="background: var(--slytherin-dark); padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                            <h2 style="color: var(--accent-gold); margin-bottom: 20px;">📋 Mô tả chi tiết</h2>
                            <div style="color: var(--slytherin-silver); line-height: 1.8;">${
                              course.description
                            }</div>
                            
                            ${
                              course.what_you_learn
                                ? `
                                <h3 style="color: var(--accent-gold); margin: 20px 0 15px 0;">🎯 Bạn sẽ học được:</h3>
                                <ul style="color: var(--slytherin-silver); line-height: 1.6;">
                                    ${course.what_you_learn
                                      .split("\n")
                                      .map((item) => `<li>${item}</li>`)
                                      .join("")}
                                </ul>
                            `
                                : ""
                            }

                            ${
                              course.requirements
                                ? `
                                <h3 style="color: var(--accent-gold); margin: 20px 0 15px 0;">📚 Yêu cầu:</h3>
                                <ul style="color: var(--slytherin-silver); line-height: 1.6;">
                                    ${course.requirements
                                      .split("\n")
                                      .map((item) => `<li>${item}</li>`)
                                      .join("")}
                                </ul>
                            `
                                : ""
                            }

                            ${
                              course.target_audience
                                ? `
                                <h3 style="color: var(--accent-gold); margin: 20px 0 15px 0;">👥 Đối tượng học viên:</h3>
                                <p style="color: var(--slytherin-silver); line-height: 1.6;">${course.target_audience}</p>
                            `
                                : ""
                            }
                        </div>

                        <div style="background: var(--slytherin-dark); padding: 30px; border-radius: 15px;">
                            <h2 style="color: var(--accent-gold); margin-bottom: 20px;">📚 Đề cương khóa học</h2>
                            <div>
                                ${chapters
                                  .map((chapter, index) => {
                                    const videoStatus =
                                      videos[chapter] || "pending";
                                    const statusIcon =
                                      videoStatus === "completed"
                                        ? "✅"
                                        : videoStatus === "pending"
                                        ? "⏳"
                                        : "📝";
                                    const statusText =
                                      videoStatus === "completed"
                                        ? "Hoàn thành"
                                        : videoStatus === "pending"
                                        ? "Đang cập nhật"
                                        : "Bản nháp";

                                    return `
                                        <div style="background: var(--slytherin-green); margin: 10px 0; padding: 15px 20px; border-radius: 10px; cursor: pointer; transition: all 0.3s ease;" 
                                             onmouseover="this.style.background='var(--slytherin-light)'" 
                                             onmouseout="this.style.background='var(--slytherin-green)'"
                                             onclick="showChapterDetail('${
                                               course.id
                                             }', '${chapter}')">
                                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                                <div>
                                                    <div style="font-weight: 600; color: white; margin-bottom: 5px;">Chương ${
                                                      index + 1
                                                    }: ${chapter}</div>
                                                    <div style="color: var(--slytherin-silver); font-size: 0.9rem;">5 bài học • 2 giờ 30 phút</div>
                                                </div>
                                                <div style="display: flex; align-items: center; gap: 10px;">
                                                    <span style="color: var(--slytherin-silver); font-size: 0.8rem;">${statusText}</span>
                                                    <span style="font-size: 1.2rem;">${statusIcon}</span>
                                                    ${
                                                      index < 3
                                                        ? '<span style="color: var(--accent-gold); font-size: 0.8rem;">👁️ Xem trước</span>'
                                                        : ""
                                                    }
                                                </div>
                                            </div>
                                        </div>
                                    `;
                                  })
                                  .join("")}
                            </div>
                        </div>
                    </div>

                    <div>
                        <div style="background: var(--slytherin-dark); padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                            <h3 style="color: var(--accent-gold); margin-bottom: 20px;">👨‍🏫 Giảng viên</h3>
                            <div style="text-align: center;">
                                <div style="width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(45deg, var(--slytherin-light), var(--accent-gold)); margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem; font-weight: bold;">
                                    ${instructorAvatar}
                                </div>
                                <div style="font-size: 1.2rem; font-weight: 600; color: white; margin-bottom: 10px;">${
                                  course.instructor
                                }</div>
                                <div style="color: var(--slytherin-silver); font-size: 0.9rem;">${instructorExperience}+ năm kinh nghiệm</div>
                                <p style="color: var(--slytherin-silver); font-size: 0.9rem; margin-top: 15px; text-align: left;">
                                    ${instructorBio}
                                </p>
                            </div>
                        </div>

                        ${
                          relatedCourses.length > 0
                            ? `
                            <div style="background: var(--slytherin-dark); padding: 25px; border-radius: 15px;">
                                <h3 style="color: var(--accent-gold); margin-bottom: 20px;">📚 Khóa học liên quan</h3>
                                ${relatedCourses
                                  .map(
                                    (related) => `
                                    <div style="display: flex; gap: 15px; margin-bottom: 15px; padding: 10px; background: var(--slytherin-green); border-radius: 8px; cursor: pointer;" onclick="showCourseDetail('${
                                      related.id
                                    }')">
                                        <div style="width: 50px; height: 50px; background: linear-gradient(45deg, var(--slytherin-light), var(--accent-gold)); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                                            ${related.image}
                                        </div>
                                        <div style="flex: 1;">
                                            <div style="color: white; font-weight: 600; font-size: 0.9rem; margin-bottom: 5px;">${
                                              related.title
                                            }</div>
                                            <div style="color: var(--accent-gold); font-size: 0.8rem;">${formatPrice(
                                              related.discount_price ||
                                                related.price
                                            )}</div>
                                        </div>
                                    </div>
                                `
                                  )
                                  .join("")}
                            </div>
                        `
                            : ""
                        }
                    </div>
                </div>
            `;

        document.getElementById("courseDetailContent").innerHTML = detailHtml;
        showSection("courseDetail");
      }

      // Show chapter detail
      function showChapterDetail(courseId, chapterName) {
        const course = allCourses.find((c) => c.id === courseId);
        if (!course) return;

        const videos = JSON.parse(course.videos || "{}");
        const videoStatus = videos[chapterName] || "pending";

        const chapterContent = `
                <div style="margin-bottom: 30px;">
                    <h3 style="color: var(--accent-gold); margin-bottom: 15px;">${chapterName}</h3>
                    <div style="background: var(--slytherin-green); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <span style="color: white; font-weight: 600;">Trạng thái:</span>
                            <span class="status-badge ${
                              videoStatus === "completed"
                                ? "status-completed"
                                : videoStatus === "pending"
                                ? "status-incomplete"
                                : "status-draft"
                            }">
                                ${
                                  videoStatus === "completed"
                                    ? "Hoàn thành"
                                    : videoStatus === "pending"
                                    ? "Đang cập nhật"
                                    : "Bản nháp"
                                }
                            </span>
                        </div>
                        
                        ${
                          videoStatus === "completed"
                            ? `
                            <div style="background: var(--slytherin-dark); padding: 20px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 3rem; margin-bottom: 15px;">🎥</div>
                                <p style="color: var(--slytherin-silver); margin-bottom: 15px;">Video bài giảng đã sẵn sàng</p>
                                <button class="btn btn-primary">▶️ Xem video</button>
                            </div>
                        `
                            : `
                            <div style="background: var(--slytherin-dark); padding: 20px; border-radius: 8px; text-align: center;">
                                <div style="font-size: 3rem; margin-bottom: 15px;">⏳</div>
                                <p style="color: var(--slytherin-silver);">Video đang được cập nhật. Vui lòng quay lại sau.</p>
                            </div>
                        `
                        }
                    </div>

                    <div style="background: var(--slytherin-green); padding: 20px; border-radius: 10px;">
                        <h4 style="color: var(--accent-gold); margin-bottom: 15px;">📋 Nội dung chương</h4>
                        <ul style="color: var(--slytherin-silver); line-height: 1.8;">
                            <li>Giới thiệu về chủ đề</li>
                            <li>Lý thuyết cơ bản</li>
                            <li>Thực hành với ví dụ</li>
                            <li>Bài tập và quiz</li>
                            <li>Tổng kết và review</li>
                        </ul>
                    </div>
                </div>
            `;

        document.getElementById("chapterContent").innerHTML = chapterContent;
        document.getElementById("chapterModalTitle").textContent = chapterName;
        document.getElementById("chapterModal").classList.add("show");
      }

      // Close chapter modal
      function closeChapterModal() {
        document.getElementById("chapterModal").classList.remove("show");
      }

      // Authentication functions
      function switchTab(tabName) {
        document
          .querySelectorAll(".tab-btn")
          .forEach((btn) => btn.classList.remove("active"));
        document
          .querySelectorAll(".tab-content")
          .forEach((content) => content.classList.remove("active"));

        event.target.classList.add("active");
        document.getElementById(tabName + "Tab").classList.add("active");
      }

      async function handleLogin(event) {
        event.preventDefault();

        const email = document.getElementById("loginEmail").value;
        const password = document.getElementById("loginPassword").value;

        // Simple authentication (in real app, this would be server-side)
        const user = allUsers.find((u) => u.user_email === email);

        if (user && user.password === password) {
          currentUser = user;
          updateAuthUI();
          showToast("Đăng nhập thành công!", "success");
          showSection("home");
        } else {
          showToast("Email hoặc mật khẩu không đúng!", "error");
        }
      }

      async function handleRegister(event) {
        event.preventDefault();

        const name = document.getElementById("registerName").value;
        const email = document.getElementById("registerEmail").value;
        const password = document.getElementById("registerPassword").value;
        const userType = document.getElementById("registerUserType").value;

        // Check if email already exists
        const existingUser = allUsers.find((u) => u.user_email === email);
        if (existingUser) {
          showToast("Email đã được sử dụng!", "error");
          return;
        }

        const newUser = {
          id: "user_" + Date.now(),
          type: "user",
          user_name: name,
          user_email: email,
          password: password,
          user_type: userType,
          bio: userType === "instructor" ? "Giảng viên mới tham gia" : "",
          experience: userType === "instructor" ? "1" : "",
          avatar: userType === "instructor" ? "👨‍🏫" : "👤",
          social_links: JSON.stringify({}),
          watchlist: JSON.stringify([]),
          enrolled_courses: JSON.stringify([]),
          progress: JSON.stringify({}),
          created_at: new Date().toISOString(),
        };

        const result = await window.dataSdk.create(newUser);
        if (result.isOk) {
          currentUser = newUser;
          updateAuthUI();
          showToast("Đăng ký thành công!", "success");
          showSection("home");
        } else {
          showToast("Đăng ký thất bại!", "error");
        }
      }

      function updateAuthUI() {
        if (currentUser) {
          document.getElementById("guestButtons").style.display = "none";
          document.getElementById("userButtons").style.display = "flex";
          document.getElementById(
            "welcomeUser"
          ).textContent = `Xin chào, ${currentUser.user_name}`;

          // Show instructor/admin tabs if applicable
          if (currentUser.user_type === "instructor") {
            document.getElementById("instructorTab").style.display = "block";
            document.getElementById("instructorFields").style.display = "grid";
            document.getElementById("bioField").style.display = "block";
          }
          if (currentUser.user_type === "admin") {
            document.getElementById("adminTab").style.display = "block";
          }
        } else {
          document.getElementById("guestButtons").style.display = "flex";
          document.getElementById("userButtons").style.display = "none";
          document.getElementById("instructorTab").style.display = "none";
          document.getElementById("adminTab").style.display = "none";
          document.getElementById("instructorFields").style.display = "none";
          document.getElementById("bioField").style.display = "none";
        }
      }

      function logout() {
        currentUser = null;
        updateAuthUI();
        showToast("Đã đăng xuất!", "success");
        showSection("home");
      }

      // Profile functions
      function switchProfileTab(tabName) {
        document
          .querySelectorAll(".tab-btn")
          .forEach((btn) => btn.classList.remove("active"));
        document
          .querySelectorAll(".tab-content")
          .forEach((content) => content.classList.remove("active"));

        event.target.classList.add("active");
        document
          .getElementById(
            "profile" + tabName.charAt(0).toUpperCase() + tabName.slice(1)
          )
          .classList.add("active");

        if (tabName === "watchlist") {
          loadWatchlist();
        } else if (tabName === "enrolled") {
          loadEnrolledCourses();
        } else if (tabName === "instructor") {
          loadInstructorCourses();
        } else if (tabName === "admin") {
          loadAdminData();
        }
      }

      function loadProfileData() {
        if (currentUser) {
          document.getElementById("profileName").value = currentUser.user_name;
          document.getElementById("profileEmail").value =
            currentUser.user_email;

          if (currentUser.user_type === "instructor") {
            document.getElementById("profileBio").value = currentUser.bio || "";
            document.getElementById("profileExperience").value =
              currentUser.experience || "";
            document.getElementById("profileAvatar").value =
              currentUser.avatar || "";
          }
        }
      }

      async function updateProfile(event) {
        event.preventDefault();

        if (!currentUser) return;

        const currentPassword =
          document.getElementById("currentPassword").value;
        const newPassword = document.getElementById("newPassword").value;

        if (currentPassword !== currentUser.password) {
          showToast("Mật khẩu hiện tại không đúng!", "error");
          return;
        }

        const updatedUser = {
          ...currentUser,
          user_name: document.getElementById("profileName").value,
          user_email: document.getElementById("profileEmail").value,
          password: newPassword || currentUser.password,
        };

        // Update instructor-specific fields
        if (currentUser.user_type === "instructor") {
          updatedUser.bio = document.getElementById("profileBio").value;
          updatedUser.experience =
            document.getElementById("profileExperience").value;
          updatedUser.avatar = document.getElementById("profileAvatar").value;
        }

        const result = await window.dataSdk.update(updatedUser);
        if (result.isOk) {
          currentUser = updatedUser;
          updateAuthUI();
          showToast("Cập nhật thông tin thành công!", "success");
        } else {
          showToast("Cập nhật thất bại!", "error");
        }
      }

      // Course management functions
      function showAddCourseForm() {
        currentEditingCourse = null;
        document.getElementById("courseModalTitle").textContent =
          "Thêm khóa học mới";
        document.getElementById("courseForm").reset();

        // Clear chapters
        document.getElementById("chaptersContainer").innerHTML = `
                <div class="chapter-item">
                    <input type="text" class="form-input" placeholder="Tên chương 1" style="margin-bottom: 10px;">
                    <button type="button" class="btn btn-danger btn-sm" onclick="removeChapter(this)">Xóa</button>
                </div>
            `;

        // Clear editor
        if (descriptionEditor) {
          descriptionEditor.setContents([]);
        }

        document.getElementById("courseModal").classList.add("show");
      }

      function editCourse(courseId) {
        const course = allCourses.find((c) => c.id === courseId);
        if (!course || course.instructor_id !== currentUser.id) return;

        currentEditingCourse = course;
        document.getElementById("courseModalTitle").textContent =
          "Chỉnh sửa khóa học";

        // Fill form with course data
        document.getElementById("courseTitle").value = course.title;
        document.getElementById("courseImage").value = course.image;
        document.getElementById("courseCategory").value = course.category;
        updateSubcategories();
        document.getElementById("courseSubcategory").value = course.subcategory;
        document.getElementById("coursePrice").value = course.price;
        document.getElementById("courseDiscountPrice").value =
          course.discount_price || "";
        document.getElementById("courseRequirements").value =
          course.requirements || "";
        document.getElementById("courseWhatYouLearn").value =
          course.what_you_learn || "";
        document.getElementById("courseTargetAudience").value =
          course.target_audience || "";

        // Set editor content
        if (descriptionEditor) {
          descriptionEditor.root.innerHTML = course.description;
        }

        // Fill chapters
        const chapters = JSON.parse(course.chapters || "[]");
        const chaptersContainer = document.getElementById("chaptersContainer");
        chaptersContainer.innerHTML = chapters
          .map(
            (chapter, index) => `
                <div class="chapter-item">
                    <input type="text" class="form-input" value="${chapter}" placeholder="Tên chương ${
              index + 1
            }" style="margin-bottom: 10px;">
                    <button type="button" class="btn btn-danger btn-sm" onclick="removeChapter(this)">Xóa</button>
                </div>
            `
          )
          .join("");

        document.getElementById("courseModal").classList.add("show");
      }

      function closeCourseModal() {
        document.getElementById("courseModal").classList.remove("show");
        currentEditingCourse = null;
      }

      // Update subcategories based on selected category
      document.addEventListener("change", function (event) {
        if (event.target.id === "courseCategory") {
          updateSubcategories();
        }
      });

      function updateSubcategories() {
        const category = document.getElementById("courseCategory").value;
        const subcategorySelect = document.getElementById("courseSubcategory");

        subcategorySelect.innerHTML =
          '<option value="">Chọn chuyên ngành</option>';

        if (category && subcategoryMap[category]) {
          subcategoryMap[category].forEach((sub) => {
            const option = document.createElement("option");
            option.value = sub;
            option.textContent = sub;
            subcategorySelect.appendChild(option);
          });
        }
      }

      function addChapter() {
        const container = document.getElementById("chaptersContainer");
        const chapterCount = container.children.length + 1;

        const chapterDiv = document.createElement("div");
        chapterDiv.className = "chapter-item";
        chapterDiv.innerHTML = `
                <input type="text" class="form-input" placeholder="Tên chương ${chapterCount}" style="margin-bottom: 10px;">
                <button type="button" class="btn btn-danger btn-sm" onclick="removeChapter(this)">Xóa</button>
            `;

        container.appendChild(chapterDiv);
      }

      function removeChapter(button) {
        const container = document.getElementById("chaptersContainer");
        if (container.children.length > 1) {
          button.parentElement.remove();
        } else {
          showToast("Phải có ít nhất một chương!", "error");
        }
      }

      async function saveCourse(event) {
        event.preventDefault();

        if (!currentUser || currentUser.user_type !== "instructor") {
          showToast("Chỉ giảng viên mới có thể tạo khóa học!", "error");
          return;
        }

        // Check course limit
        if (!currentEditingCourse && allCourses.length >= 999) {
          showToast("Đã đạt giới hạn tối đa 999 khóa học!", "error");
          return;
        }

        // Get form data
        const title = document.getElementById("courseTitle").value;
        const image = document.getElementById("courseImage").value || "📚";
        const category = document.getElementById("courseCategory").value;
        const subcategory = document.getElementById("courseSubcategory").value;
        const price = parseInt(document.getElementById("coursePrice").value);
        const discountPrice = document.getElementById("courseDiscountPrice")
          .value
          ? parseInt(document.getElementById("courseDiscountPrice").value)
          : null;
        const requirements =
          document.getElementById("courseRequirements").value;
        const whatYouLearn =
          document.getElementById("courseWhatYouLearn").value;
        const targetAudience = document.getElementById(
          "courseTargetAudience"
        ).value;

        // Get description from editor
        const description = descriptionEditor
          ? descriptionEditor.root.innerHTML
          : "";

        // Get chapters
        const chapterInputs = document.querySelectorAll(
          "#chaptersContainer input"
        );
        const chapters = Array.from(chapterInputs)
          .map((input) => input.value.trim())
          .filter(Boolean);

        if (chapters.length === 0) {
          showToast("Phải có ít nhất một chương!", "error");
          return;
        }

        // Create videos object with pending status for all chapters
        const videos = {};
        chapters.forEach((chapter) => {
          videos[chapter] = "pending";
        });

        const courseData = {
          title,
          description,
          category,
          subcategory,
          instructor: currentUser.user_name,
          instructor_id: currentUser.id,
          instructor_bio: currentUser.bio || "",
          instructor_experience: currentUser.experience || "1",
          instructor_avatar: currentUser.avatar || "👨‍🏫",
          rating: 0,
          reviews: 0,
          students: 0,
          price,
          discount_price: discountPrice,
          image,
          featured: false,
          bestseller: false,
          new: true,
          status: "incomplete", // Start as incomplete
          chapters: JSON.stringify(chapters),
          videos: JSON.stringify(videos),
          requirements,
          what_you_learn: whatYouLearn,
          target_audience: targetAudience,
          updated_at: new Date().toISOString(),
        };

        let result;
        if (currentEditingCourse) {
          // Update existing course
          const updatedCourse = {
            ...currentEditingCourse,
            ...courseData,
          };
          result = await window.dataSdk.update(updatedCourse);
        } else {
          // Create new course
          const newCourse = {
            id: "course_" + Date.now(),
            type: "course",
            created_at: new Date().toISOString(),
            ...courseData,
          };
          result = await window.dataSdk.create(newCourse);
        }

        if (result.isOk) {
          showToast(
            currentEditingCourse
              ? "Cập nhật khóa học thành công!"
              : "Tạo khóa học thành công!",
            "success"
          );
          closeCourseModal();
          loadInstructorCourses();
        } else {
          showToast("Lưu khóa học thất bại!", "error");
        }
      }

      // Manage course content
      function manageCourseContent(courseId) {
        const course = allCourses.find((c) => c.id === courseId);
        if (!course || course.instructor_id !== currentUser.id) return;

        const chapters = JSON.parse(course.chapters || "[]");
        const videos = JSON.parse(course.videos || "{}");

        const contentHtml = `
                <div style="margin-bottom: 30px;">
                    <h3 style="color: var(--accent-gold); margin-bottom: 20px;">📚 Quản lý nội dung khóa học</h3>
                    <div style="background: var(--slytherin-green); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <span style="color: white; font-weight: 600;">Trạng thái khóa học:</span>
                            <span class="status-badge ${
                              course.status === "completed"
                                ? "status-completed"
                                : "status-incomplete"
                            }">
                                ${
                                  course.status === "completed"
                                    ? "Hoàn thành"
                                    : "Chưa hoàn thành"
                                }
                            </span>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <div style="color: var(--slytherin-silver); margin-bottom: 5px;">Tiến độ hoàn thành:</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${calculateCourseProgress(
                                  videos
                                )}%"></div>
                            </div>
                            <div style="color: var(--accent-gold); font-size: 0.9rem; margin-top: 5px;">
                                ${calculateCourseProgress(videos)}% hoàn thành
                            </div>
                        </div>
                        
                        ${
                          course.status !== "completed"
                            ? `
                            <button class="btn btn-success" onclick="markCourseComplete('${courseId}')" 
                                    ${
                                      calculateCourseProgress(videos) < 100
                                        ? "disabled"
                                        : ""
                                    }>
                                ✅ Đánh dấu hoàn thành
                            </button>
                        `
                            : ""
                        }
                    </div>

                    <div class="chapter-list">
                        <h4 style="color: var(--accent-gold); margin-bottom: 20px;">📋 Danh sách chương</h4>
                        ${chapters
                          .map((chapter, index) => {
                            const videoStatus = videos[chapter] || "pending";
                            const statusClass =
                              videoStatus === "completed"
                                ? "status-completed"
                                : videoStatus === "pending"
                                ? "status-incomplete"
                                : "status-draft";
                            const statusText =
                              videoStatus === "completed"
                                ? "Hoàn thành"
                                : videoStatus === "pending"
                                ? "Chưa hoàn thành"
                                : "Bản nháp";

                            return `
                                <div class="chapter-item">
                                    <div class="chapter-info">
                                        <div class="chapter-title">Chương ${
                                          index + 1
                                        }: ${chapter}</div>
                                        <div class="chapter-status">
                                            <span class="status-badge ${statusClass}">${statusText}</span>
                                        </div>
                                    </div>
                                    <div class="chapter-actions">
                                        <button class="btn btn-secondary btn-sm" onclick="uploadVideo('${courseId}', '${chapter}')">
                                            📹 ${
                                              videoStatus === "completed"
                                                ? "Cập nhật video"
                                                : "Upload video"
                                            }
                                        </button>
                                        ${
                                          videoStatus !== "completed"
                                            ? `
                                            <button class="btn btn-success btn-sm" onclick="markChapterComplete('${courseId}', '${chapter}')">
                                                ✅ Hoàn thành
                                            </button>
                                        `
                                            : ""
                                        }
                                    </div>
                                </div>
                            `;
                          })
                          .join("")}
                    </div>
                </div>
            `;

        document.getElementById("chapterContent").innerHTML = contentHtml;
        document.getElementById(
          "chapterModalTitle"
        ).textContent = `Quản lý nội dung: ${course.title}`;
        document.getElementById("chapterModal").classList.add("show");
      }

      // Calculate course progress
      function calculateCourseProgress(videos) {
        const totalChapters = Object.keys(videos).length;
        if (totalChapters === 0) return 0;

        const completedChapters = Object.values(videos).filter(
          (status) => status === "completed"
        ).length;
        return Math.round((completedChapters / totalChapters) * 100);
      }

      // Upload video (simulated)
      function uploadVideo(courseId, chapterName) {
        const uploadHtml = `
                <div style="margin-bottom: 30px;">
                    <h3 style="color: var(--accent-gold); margin-bottom: 20px;">📹 Upload video cho: ${chapterName}</h3>
                    
                    <div class="video-upload" onclick="document.getElementById('videoFile').click()">
                        <div style="font-size: 3rem; margin-bottom: 15px;">📁</div>
                        <p style="color: var(--accent-gold); font-weight: 600; margin-bottom: 10px;">
                            Kéo thả file video vào đây hoặc click để chọn
                        </p>
                        <p style="color: var(--slytherin-silver); font-size: 0.9rem;">
                            Hỗ trợ: MP4, AVI, MOV (tối đa 500MB)
                        </p>
                        <input type="file" id="videoFile" accept="video/*" style="display: none;" onchange="handleVideoUpload('${courseId}', '${chapterName}', this)">
                    </div>
                    
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="btn btn-secondary" onclick="closeChapterModal()">Hủy</button>
                    </div>
                </div>
            `;

        document.getElementById("chapterContent").innerHTML = uploadHtml;
      }

      // Handle video upload (simulated)
      function handleVideoUpload(courseId, chapterName, input) {
        if (input.files && input.files[0]) {
          const file = input.files[0];

          // Simulate upload process
          const uploadHtml = `
                    <div style="text-align: center; padding: 40px;">
                        <div class="spinner"></div>
                        <h3 style="color: var(--accent-gold); margin: 20px 0;">Đang upload video...</h3>
                        <p style="color: var(--slytherin-silver);">File: ${file.name}</p>
                        <div class="progress-bar" style="margin: 20px 0;">
                            <div class="progress-fill" id="uploadProgress" style="width: 0%"></div>
                        </div>
                        <div id="progressText" style="color: var(--accent-gold);">0%</div>
                    </div>
                `;

          document.getElementById("chapterContent").innerHTML = uploadHtml;

          // Simulate upload progress
          let progress = 0;
          const interval = setInterval(() => {
            progress += Math.random() * 15;
            if (progress >= 100) {
              progress = 100;
              clearInterval(interval);

              // Mark chapter as completed after upload
              setTimeout(() => {
                markChapterComplete(courseId, chapterName);
              }, 1000);
            }

            document.getElementById("uploadProgress").style.width =
              progress + "%";
            document.getElementById("progressText").textContent =
              Math.round(progress) + "%";
          }, 200);
        }
      }

      // Mark chapter as complete
      async function markChapterComplete(courseId, chapterName) {
        const course = allCourses.find((c) => c.id === courseId);
        if (!course || course.instructor_id !== currentUser.id) return;

        const videos = JSON.parse(course.videos || "{}");
        videos[chapterName] = "completed";

        const updatedCourse = {
          ...course,
          videos: JSON.stringify(videos),
          updated_at: new Date().toISOString(),
        };

        const result = await window.dataSdk.update(updatedCourse);
        if (result.isOk) {
          showToast(`Đã hoàn thành chương: ${chapterName}`, "success");
          manageCourseContent(courseId); // Refresh content
        } else {
          showToast("Cập nhật thất bại!", "error");
        }
      }

      // Mark entire course as complete
      async function markCourseComplete(courseId) {
        const course = allCourses.find((c) => c.id === courseId);
        if (!course || course.instructor_id !== currentUser.id) return;

        const videos = JSON.parse(course.videos || "{}");
        const progress = calculateCourseProgress(videos);

        if (progress < 100) {
          showToast("Vui lòng hoàn thành tất cả các chương trước!", "error");
          return;
        }

        const updatedCourse = {
          ...course,
          status: "completed",
          updated_at: new Date().toISOString(),
        };

        const result = await window.dataSdk.update(updatedCourse);
        if (result.isOk) {
          showToast("Khóa học đã được đánh dấu hoàn thành!", "success");
          closeChapterModal();
          loadInstructorCourses();
        } else {
          showToast("Cập nhật thất bại!", "error");
        }
      }

      // Load instructor courses
      function loadInstructorCourses() {
        if (!currentUser || currentUser.user_type !== "instructor") return;

        const instructorCourses = allCourses.filter(
          (course) => course.instructor_id === currentUser.id
        );
        const container = document.getElementById("instructorCourses");

        if (instructorCourses.length === 0) {
          container.innerHTML = `
                    <div style="text-align: center; color: var(--slytherin-silver); padding: 60px;">
                        <h3>📚 Chưa có khóa học nào</h3>
                        <p>Hãy tạo khóa học đầu tiên của bạn</p>
                        <button class="btn btn-primary" onclick="showAddCourseForm()">➕ Tạo khóa học mới</button>
                    </div>
                `;
        } else {
          container.innerHTML = `
                    <div style="margin-bottom: 30px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px;">
                            <div style="background: var(--slytherin-green); padding: 20px; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2rem; color: var(--accent-gold); margin-bottom: 10px;">📚</div>
                                <div style="font-size: 1.5rem; font-weight: bold; color: white;">${
                                  instructorCourses.length
                                }</div>
                                <div style="color: var(--slytherin-silver); font-size: 0.9rem;">Tổng khóa học</div>
                            </div>
                            <div style="background: var(--slytherin-green); padding: 20px; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2rem; color: var(--accent-gold); margin-bottom: 10px;">✅</div>
                                <div style="font-size: 1.5rem; font-weight: bold; color: white;">${
                                  instructorCourses.filter(
                                    (c) => c.status === "completed"
                                  ).length
                                }</div>
                                <div style="color: var(--slytherin-silver); font-size: 0.9rem;">Đã hoàn thành</div>
                            </div>
                            <div style="background: var(--slytherin-green); padding: 20px; border-radius: 10px; text-align: center;">
                                <div style="font-size: 2rem; color: var(--accent-gold); margin-bottom: 10px;">👥</div>
                                <div style="font-size: 1.5rem; font-weight: bold; color: white;">${instructorCourses.reduce(
                                  (sum, c) => sum + c.students,
                                  0
                                )}</div>
                                <div style="color: var(--slytherin-silver); font-size: 0.9rem;">Tổng học viên</div>
                            </div>
                        </div>
                    </div>
                    <div class="course-grid">
                        ${instructorCourses
                          .map((course) => createCourseCard(course))
                          .join("")}
                    </div>
                `;
        }
      }

      // Course interaction functions
      async function enrollInCourse(courseId) {
        if (!currentUser) {
          showToast("Vui lòng đăng nhập để đăng ký khóa học!", "error");
          showSection("auth");
          return;
        }

        const enrolledCourses = JSON.parse(
          currentUser.enrolled_courses || "[]"
        );
        if (enrolledCourses.includes(courseId)) {
          showToast("Bạn đã đăng ký khóa học này!", "error");
          return;
        }

        enrolledCourses.push(courseId);
        const updatedUser = {
          ...currentUser,
          enrolled_courses: JSON.stringify(enrolledCourses),
        };

        const result = await window.dataSdk.update(updatedUser);
        if (result.isOk) {
          currentUser = updatedUser;
          showToast("Đăng ký khóa học thành công!", "success");
        } else {
          showToast("Đăng ký thất bại!", "error");
        }
      }

      async function toggleWatchlist(courseId) {
        if (!currentUser) {
          showToast(
            "Vui lòng đăng nhập để thêm vào danh sách yêu thích!",
            "error"
          );
          showSection("auth");
          return;
        }

        const watchlist = JSON.parse(currentUser.watchlist || "[]");
        const index = watchlist.indexOf(courseId);

        if (index > -1) {
          watchlist.splice(index, 1);
          showToast("Đã xóa khỏi danh sách yêu thích!", "success");
        } else {
          watchlist.push(courseId);
          showToast("Đã thêm vào danh sách yêu thích!", "success");
        }

        const updatedUser = {
          ...currentUser,
          watchlist: JSON.stringify(watchlist),
        };

        const result = await window.dataSdk.update(updatedUser);
        if (result.isOk) {
          currentUser = updatedUser;
        }
      }

      function loadWatchlist() {
        if (!currentUser) return;

        const watchlist = JSON.parse(currentUser.watchlist || "[]");
        const watchlistCourses = allCourses.filter((course) =>
          watchlist.includes(course.id)
        );

        const container = document.getElementById("watchlistCourses");
        if (watchlistCourses.length === 0) {
          container.innerHTML = `
                    <div style="text-align: center; color: var(--slytherin-silver); padding: 60px;">
                        <h3>💔 Danh sách yêu thích trống</h3>
                        <p>Hãy thêm các khóa học yêu thích vào danh sách</p>
                    </div>
                `;
        } else {
          container.innerHTML = watchlistCourses
            .map((course) => createCourseCard(course))
            .join("");
        }
      }

      function loadEnrolledCourses() {
        if (!currentUser) return;

        const enrolledCourses = JSON.parse(
          currentUser.enrolled_courses || "[]"
        );
        const courses = allCourses.filter((course) =>
          enrolledCourses.includes(course.id)
        );

        const container = document.getElementById("enrolledCourses");
        if (courses.length === 0) {
          container.innerHTML = `
                    <div style="text-align: center; color: var(--slytherin-silver); padding: 60px;">
                        <h3>📚 Chưa có khóa học nào</h3>
                        <p>Hãy đăng ký các khóa học để bắt đầu học</p>
                    </div>
                `;
        } else {
          container.innerHTML = courses
            .map((course) => createCourseCard(course))
            .join("");
        }
      }

      // Utility functions
      function updatePagination(containerId, totalItems) {
        const container = document.getElementById(containerId);
        const totalPages = Math.ceil(totalItems / coursesPerPage);

        if (totalPages <= 1) {
          container.innerHTML = "";
          return;
        }

        let paginationHtml = "";

        if (currentPage > 1) {
          paginationHtml += `<button class="page-btn" onclick="changePage(${
            currentPage - 1
          })">‹ Trước</button>`;
        }

        for (let i = 1; i <= totalPages; i++) {
          if (i === currentPage) {
            paginationHtml += `<button class="page-btn active">${i}</button>`;
          } else {
            paginationHtml += `<button class="page-btn" onclick="changePage(${i})">${i}</button>`;
          }
        }

        if (currentPage < totalPages) {
          paginationHtml += `<button class="page-btn" onclick="changePage(${
            currentPage + 1
          })">Sau ›</button>`;
        }

        container.innerHTML = paginationHtml;
      }

      function changePage(page) {
        currentPage = page;
        updateAllCourses();
      }

      function showToast(message, type = "info") {
        const toast = document.createElement("div");
        toast.className = `toast ${type}`;
        toast.textContent = message;

        document.body.appendChild(toast);

        setTimeout(() => {
          toast.classList.add("show");
        }, 100);

        setTimeout(() => {
          toast.classList.remove("show");
          setTimeout(() => {
            document.body.removeChild(toast);
          }, 300);
        }, 3000);
      }

      // Admin functions (simplified)
      function switchAdminTab(tabName) {
        document
          .querySelectorAll(".admin-tab")
          .forEach((btn) => btn.classList.remove("active"));
        document
          .querySelectorAll(".admin-content")
          .forEach((content) => (content.style.display = "none"));

        event.target.classList.add("active");
        document.getElementById(
          "admin" + tabName.charAt(0).toUpperCase() + tabName.slice(1)
        ).style.display = "block";
      }

      function loadAdminData() {
        // Load admin data (simplified)
        const adminCoursesContainer = document.getElementById("adminCourses");
        adminCoursesContainer.innerHTML = `
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Tên khóa học</th>
                            <th>Giảng viên</th>
                            <th>Học viên</th>
                            <th>Trạng thái</th>
                            <th>Thao tác</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${allCourses
                          .map(
                            (course) => `
                            <tr>
                                <td>${course.title}</td>
                                <td>${course.instructor}</td>
                                <td>${course.students}</td>
                                <td>
                                    <span class="status-badge ${
                                      course.status === "completed"
                                        ? "status-completed"
                                        : "status-incomplete"
                                    }">
                                        ${
                                          course.status === "completed"
                                            ? "Hoàn thành"
                                            : "Chưa hoàn thành"
                                        }
                                    </span>
                                </td>
                                <td>
                                    <button class="action-btn btn-view" onclick="showCourseDetail('${
                                      course.id
                                    }')">Xem</button>
                                    <button class="action-btn btn-delete" onclick="deleteCourse('${
                                      course.id
                                    }')">Xóa</button>
                                </td>
                            </tr>
                        `
                          )
                          .join("")}
                    </tbody>
                </table>
            `;
      }

      async function deleteCourse(courseId) {
        if (!currentUser || currentUser.user_type !== "admin") {
          showToast("Không có quyền thực hiện thao tác này!", "error");
          return;
        }

        const course = allCourses.find((c) => c.id === courseId);
        if (course) {
          const result = await window.dataSdk.delete(course);
          if (result.isOk) {
            showToast("Xóa khóa học thành công!", "success");
            loadAdminData();
          } else {
            showToast("Xóa khóa học thất bại!", "error");
          }
        }
      }

      // Initialize app when page loads
      document.addEventListener("DOMContentLoaded", initializeApp);
    </script>
    <script>
      (function () {
        function c() {
          var b = a.contentDocument || a.contentWindow.document;
          if (b) {
            var d = b.createElement("script");
            d.innerHTML =
              "window.__CF$cv$params={r:'994ad4ec511b3fd0',t:'MTc2MTQ5MDkxNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
            b.getElementsByTagName("head")[0].appendChild(d);
          }
        }
        if (document.body) {
          var a = document.createElement("iframe");
          a.height = 1;
          a.width = 1;
          a.style.position = "absolute";
          a.style.top = 0;
          a.style.left = 0;
          a.style.border = "none";
          a.style.visibility = "hidden";
          document.body.appendChild(a);
          if ("loading" !== document.readyState) c();
          else if (window.addEventListener)
            document.addEventListener("DOMContentLoaded", c);
          else {
            var e = document.onreadystatechange || function () {};
            document.onreadystatechange = function (b) {
              e(b);
              "loading" !== document.readyState &&
                ((document.onreadystatechange = e), c());
            };
          }
        }
      })();
    </script>
  </body>
</html>
